       IDENTIFICATION   DIVISION.                                       
       PROGRAM-ID.      ADPP03D.                                        
       AUTHOR.          CPM-CARLOS JR.                                  
       DATE-WRITTEN.    21/02/2002.                                     
       DATE-COMPILED.                                                   
       SECURITY.                                                        
      ******************************************************************
      *           VCR - VIRTUAL CRED                                   *
      *           ------------------                                   *
      *                                                                *
      *           SERVICO (API) DE ACESSOS  AOS VSAM'S DE PROPOSTAS    *
      *           (ADPA061 - CAD.PROPOSTAS    )                        *
      *           (ADPA062 - CAD.PESSAO X PROP)                        *
      *           (ADPA063 - GARANTIAS        )                        *
      *           (ADPA004 - APROVACAO        )                        *
      *           (ADPA008 - BENS             )                        *
      *                                                                *
      * O PGM TRABALHA COM O BOOK VCRC080, RECEBENDO                   *
      *        A AREA CORRESPONDENTE AO VCRC080, ONDE:                 *
      * VCRC080-E-CRITERIO:                                            *
      *                 03=CONSULTA SINTETICA+SUMARIZADA               *
      *                 02=CONSULTA ESPECIFICA(DETALHADA)              *
      *                 01=CONSULTA SINTETICA(RESUMIDA)                *
      *     O PROGRAMA SUBDIVIDE, INTERNAMENTE, A CONSULTA SINTETICA,  *
      * ATRAVES DO CAMPO VCRC080-E-CRITERIO, ASSUMINDO OS VALORES:     *
      *                 11=CONSULTA POR CPF                            *
      *                 12=CONSULTA CPF+PERIODO                        *
      *                 13=CONSULTA CPF+PERIODO+STATUS                 *
      *                 14=CONSULTA CPF+STATUS                         *
      *                 15=CONSULTA PERIODO+STATUS                     *
      *                 16=CONSULTA PERIODO                            *
      *                 17=CONSULTA STATUS                             *
      *                 21=CONSULTA DOCTOS IMPRESSOS                   *
      *                 23=CONSULTA DOCTOS IMPRESSOS SUMARIZADOS       *
      ******************************************************************
      * PROGRAMADOR     ¶ ANALISTA    ¶  DATA  ¶          MOTIVO       *
      *-----------------+-------------+--------+-----------------------*
010903* CARLOS A.S.JR   ¶ MULTIFILIAIS¶26/09/03¶. PESQUISA FILIAL COR  *
230903* CARLOS A.S.JR   ¶CLIENTE DESDE¶26/09/03¶. CALCULAR QTTMPCTA    *
121203* CARLOS A.S.JR   ¶             |12/12/03¶. UNIFICACAO  ADP      *
191203* CARLOS A.S.JR   ¶             |19/12/03¶. TIRAR ARQUIVO ADPA008*
050304* CARLOS A.S.JR   ¶             |05/03/04¶. SUPORG / FORMALIZACAO*
230704* CARLOS A.S.JR   ¶             |23/07/04¶. SUPORG / FORMALIZACAO*
230704*                 ¶             ACERTO PAGINACAO QDO. PESQUISA   *
230704*                 ¶             PARA TODOS INTERMEDIARIOS(999999)*
200804* CARLOS A.S.JR   ¶             |13/08/04¶. VIC  SUBSIDIO        *
100904*                 ¶             ACERTO PAGINACAO QDO. PESQUISA   *
100904*                 ¶             PARA TODOS INTERMEDIARIOS(999999)*
270904* CARLOS A.S.JR   ¶             |13/09/04¶. DATA DA CONFIRM.CRED.*
281004* CARLOS A.S.JR   ¶             |28/10/04¶. TIPO DE CONFIRM.CRED.*
121104* CARLOS A.S.JR   ¶             |12/11/04¶. TIPO DE CONFIRM.CRED.*
311005* CARLOS A.S.JR   ¶             ¶31/10/05¶.NOVA CENTRAL-ST PROP  *
311005*    OBSERVACAO==>¶OS PRÛPRIOS DADOS DE RESPOSTA(LEITURAS) SERVEM*
311005*                 ¶COMO PONTEIROS POSICIONAIS DENTRO DA BASE. E  *
311005*                 ¶NO CASO, O "ADP061-CD-STATUS" È CRUCIAL       *
311005*                 ¶NESSE POSICIONAMENTO. ESSE CONJUNTO DE REGS.  *
311005*                 ¶RETORNADOS TEM SUA QUANTIDADE INDETERMINADA,  *
311005*                 ¶LEVANDO A APLICA«„O PERMITIR A PAGINA«„O      *
311005*                 ¶DIN¬MICA DESSES  DADOS,OU SEJA, A CADA        *
311005*                 ¶PAGEUP/PAGEDOWN A BASE È ACIONADA             *
311005*                 ¶ATRAVÈS DE ALGORITMO DE POSICIONAMENTO        *
311005*                 ¶ESPECÌFICO DE PONTEIRO.                       *
311005*                 ¶PORTANTO O MONITORAMENTO DE PROPOSTAS         *
311005*                 ¶ ( VCA8 ), TER· COMPROMETIDA A  PAGINA«AO.    *
311005*                 ¶                                              *
CD6939* SANDRA M. G.    ¶ROTINA QUE VERIFICA NOME DO VENDEDOR - CET    *
      *----------------------------------------------------------------*
      * ALTERACAO : EXPANSAO DOS ARQUIVOS: ADPA061 E ADPA062           *
      *             EXCLUSAO DO CAMPO CODIGO FILIAL DA LOJA DO ADPA061 *
      * MANUTENCAO EFETUADA POR OSCAR MENDES(STEFANINI) EM 07/08/2008  *
      *----------------------------------------------------------------*
      * ALTERACAO : ADEQUACAO DE STATUS DE ACORDO COM A PARAMETRIZACAO *
      *             DA NOVA CENTRAL                                    *
      * MANUTENCAO EFETUADA POR OSCAR MENDES(STEFANINI) EM 02/12/2008  *
      *----------------------------------------------------------------*
       ENVIRONMENT      DIVISION.                                       
       CONFIGURATION SECTION.                                           
      ******************************************************************
      *                          PROGRAMA CICS                         *
      ******************************************************************
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA.                           
       DATA             DIVISION.                                       
       WORKING-STORAGE SECTION.                                         
                                                                        
       01          FILLER              PIC  X(09)  VALUE 'INICIO-WK'.   
      ******************************************************************
      *                 INICIO DA WORKING STORAGE                       
      ******************************************************************
      *                                                                 
      *                                                                 
      ******************************************************************
       01          FILLER.                                              
         03        FILLER              PIC  X(12)  VALUE 'AUXILIAR'.    
      *                                                                 
070808   03        WS-LEN-A061         PIC S9(04) COMP VALUE +2150.     
070808   03        WS-LEN-A062         PIC S9(04) COMP VALUE +2600.     
121203   03        WS-LEN-A003         PIC S9(04) COMP VALUE +400.      
         03        WS-LEN-A004         PIC S9(04) COMP VALUE +112.      
         03        WS-LEN-A662         PIC S9(04) COMP VALUE +112.      
         03        WS-KEY-LEN-A061     PIC S9(04) COMP VALUE +10.       
         03        WS-KEY-LEN-P061     PIC S9(04) COMP VALUE +37.       
         03        WS-KEY-LEN-A062     PIC S9(04) COMP VALUE +12.       
         03        WS-KEY-LEN-P062     PIC S9(04) COMP VALUE +16.       
         03        WS-KEY-LEN-A003     PIC S9(04) COMP VALUE +12.       
         03        WS-KEY-LEN-A004     PIC S9(04) COMP VALUE +11.       
         03        WS-KEY-LEN-P004     PIC S9(04) COMP VALUE +10.       
         03        WS-KEY-LEN-A008     PIC S9(04) COMP VALUE +14.       
         03        WS-KEY-LEN-A662     PIC S9(04) COMP VALUE +06.       
270904   03        WS-A051-DATA-CHEC   PIC  9(08) VALUE ZEROES.         
121203   03        WS-A061             PIC  X(08) VALUE 'ADPA061 '.     
121203   03        WS-P061             PIC  X(08) VALUE 'ADPP061 '.     
121203   03        WS-A062             PIC  X(08) VALUE 'ADPA062 '.     
121203   03        WS-P062             PIC  X(08) VALUE 'ADPP062 '.     
121203   03        WS-A003             PIC  X(08) VALUE 'ADPA063 '.     
         03        WS-A004             PIC  X(08) VALUE 'ADPA004 '.     
         03        WS-P004             PIC  X(08) VALUE 'ADPP004 '.     
         03        WS-A662             PIC  X(08) VALUE 'TABA662 '.     
         03        FL-FIM              PIC  X(03)  VALUE  'NAO'.        
270904   03        WS-OCOR-MAX         PIC S9(04)  COMP   VALUE +140.   
      *                                                                 
121203   03      WS-BIN-5F           PIC S9(04)  COMP   VALUE +95.      
CA1803   03      FILLER              REDEFINES   WS-BIN-5F.             
CA1803     07      WS-BIN-5F-1         PIC  X(01).                      
CA1803     07      WS-BIN-5F-2         PIC  X(01).                      
050304   03      WS-BIN-FD           PIC S9(04)  COMP   VALUE +253.     
CA1803   03      FILLER              REDEFINES   WS-BIN-FD.             
CA1803     07      WS-BIN-FD-1         PIC  X(01).                      
CA1803     07      WS-BIN-FD-2         PIC  X(01).                      
050304   03      WS-BIN-24573        PIC S9(04)  COMP   VALUE +0.       
CA1803   03      FILLER              REDEFINES   WS-BIN-24573.          
CA1803     07      WS-BIN-1            PIC  X(01).                      
CA1803     07      WS-BIN-2            PIC  X(01).                      
      *                                                                 
         03        WS-IND              PIC S9(04)  COMP   VALUE +0.     
         03        WS-IND-S            PIC S9(04)  COMP   VALUE +0.     
270904   03        WS-IND-F            PIC S9(04)  COMP   VALUE +140.   
CA2203   03        WS-IND-I1           PIC S9(04)  COMP   VALUE +0.     
CA2203   03        WS-IND-I2           PIC S9(04)  COMP   VALUE +0.     
CA1203   03        WS-IND-STA          PIC S9(04)  COMP   VALUE +0.     
CA1908   03        WS-IND-PRD          PIC S9(04)  COMP   VALUE +0.     
         03        WS-IND-SEG          PIC S9(04)  COMP   VALUE +0.     
         03        WS-IND-LOJA         PIC S9(04)  COMP   VALUE +0.     
CA1203   03        WS-IND-LOJA-AUX     PIC S9(04)  COMP   VALUE +0.     
CA1203   03        WS-IND-SEG-AUX      PIC S9(04)  COMP   VALUE +0.     
CA1203   03        WS-IND-STA-AUX      PIC S9(04)  COMP   VALUE +0.     
         03        WS-IND-FIL          PIC S9(04)  COMP   VALUE +0.     
         03        IN-ADP013           PIC S9(04)  COMP   VALUE +0.     
         03        WCH-ACHOU           PIC  9(01)         VALUE  0.     
CA2303   03        WCH-OBTEM-IND       PIC  9(01)         VALUE  0.     
CA2203   03        WCH-INVERTE         PIC  9(01)         VALUE  0.     
CA2803   03        WCH-QUEBRA-STA        PIC  9(01)         VALUE  0.   
CA1203   03        WCH-PESQ-PROX         PIC  X(01)         VALUE 'N'.  
CA1203   03        WCH-PESQ-ANT          PIC  X(01)         VALUE 'N'.  
CA2203   03        WCH-PROPOSTA-ANT.                                    
CA2603     05      WCH-AGENC             PIC  9(03)         VALUE 0.    
CA2603     05      WCH-SUBSEG            PIC  9(03)         VALUE 0.    
CA2603     05      WCH-CD-STATUS         PIC  X(02)         VALUE ' '.  
CA2603     05      WCH-CD-LOJA           PIC  9(06)         VALUE 0.    
CA2603     05      WCH-CD-FIL-LOJA       PIC  9(05)         VALUE 0.    
CA2603     05      WCH-DT-INCLUSAO       PIC  9(08)         VALUE 0.    
CA2603     05      WCH-CD-PROPOSTA-ADP-2 PIC  9(10)         VALUE 0.    
CA1203   03        WCH-BROWSE            PIC  X(04)         VALUE ' '.  
CA2103   03        WS-SENTIDO-CONSULTA   PIC  X(01)         VALUE ' '.  
050304   03        WS-E-CRITERIO         PIC  9(02)         VALUE 0.    
230903   03        WS-ANOABERTURA.                                      
230903    05       WS-AAAA-ABERT         PIC  9(04)         VALUE 0.    
230903   03        WS-MESABERTURA.                                      
230903    05       WS-MM-ABERT           PIC  9(02)         VALUE 0.    
230903   03        WS-ANO-CP3            PIC S9(03) COMP-3  VALUE +0.   
230903   03        WS-MES-CP3            PIC S9(03) COMP-3  VALUE +0.   
      *                                                                 
         03        WS-DT-DMY           PIC  9(008)  VALUE 0.            
         03        WS-DT-DMY-R    REDEFINES WS-DT-DMY.                  
          05       WS-DIA-DMY          PIC  9(002).                     
          05       WS-MES-DMY          PIC  9(002).                     
          05       WS-ANO-DMY          PIC  9(004).                     
      *                                                                 
         03        WS-DT-YMD           PIC  9(008)  VALUE 0.            
         03        WS-DT-YMD-R    REDEFINES WS-DT-YMD.                  
          05       WS-ANO-YMD          PIC  9(004).                     
          05       WS-MES-YMD          PIC  9(002).                     
          05       WS-DIA-YMD          PIC  9(002).                     
      *                                                                 
         03        WS-DT-COR           PIC  9(008)  VALUE 0.            
         03        WS-DT-COR-R    REDEFINES WS-DT-COR.                  
          05       WS-ANO-COR          PIC  9(004).                     
          05       WS-MES-COR          PIC  9(002).                     
          05       WS-DIA-COR          PIC  9(002).                     
      *                                                                 
       01          FILLER.                                              
         03        WS-DT-YMD-1         PIC  9(008)  VALUE 0.            
      *                                                                 
281004  01  W-ADPB051-REG.                                              
281004        05 W-ADPB051-CHAVE.                                       
281004           10 W-ADPB051-CD-PROPOSTA-ADP  PIC 9(10) VALUE ZEROES.  
281004           10 W-ADPB051-CD-PESSOA        PIC 9(02) VALUE ZEROES.  
281004           10 W-ADPB051-TIPO             PIC X(03) VALUE SPACES.  
281004           10 W-ADPB051-DATA-CHEC        PIC 9(08) VALUE ZEROES.  
281004           10 W-ADPB051-HORA-CHEC        PIC 9(06) VALUE ZEROES.  
281004        05 W-ADPB051-CODIGO              PIC 9(03) VALUE ZEROES.  
281004        05 W-ADPB051-DESCRICAO           PIC X(40) VALUE SPACES.  
281004        05 W-ADPB051-STATUS              PIC X(01) VALUE SPACES.  
281004        05 W-ADPB051-FLAG-OBSERVACAO     PIC X(01) VALUE SPACES.  
281004        05 W-ADPB051-CDUSERID            PIC X(08) VALUE SPACES.  
281004        05 FILLER                        PIC X(18).               
      *                                                                 
      ***************************************************************** 
      * BOOK PARA ROTINA @DATA                                        * 
      ***************************************************************** 
       01  FILLER                                 PIC  X(20)  VALUE     
                                  '*** BOOK BDATA    **'.               
          COPY BDATA.                                                   
      *                                                                 
230903 01       WS-AREA-ABEND1         PIC  X(100).                     
230903 01       WS-AREA-ABEND2         PIC  X(100).                     
      *                                                                 
      ***************************************************************** 
230903  01    WTB-FIL-PROP.                                             
CA2503    05  WTB-FIL-PROPOSTA.                                         
CA2503      07  FILLER                 PIC  9(010)  VALUE 0.            
CA2503      07  FILLER                 PIC  9(011)  VALUE 0.            
CA2503      07  FILLER                 PIC  X(060)  VALUE ' '.          
CA2503      07  FILLER                 PIC  X(002)  VALUE ' '.          
CA2503      07  FILLER                 PIC  X(014)  VALUE ' '.          
CA2503      07  FILLER                 PIC  9(008)  VALUE 0.            
CA2503      07  FILLER                 PIC  9(008)  VALUE 0.            
270904      07  FILLER                 PIC  9(008)  VALUE 0.            
CA2503      07  FILLER                 PIC  9(13)V99 VALUE 0.           
050304      07  FILLER                 PIC  9(006)  VALUE 0.            
050304      07  FILLER                 PIC  X(002)  VALUE ' '.          
050304      07  FILLER                 PIC  9(002)  VALUE 0.            
CA2503    05  FILLER.                                                   
CA2503      07  WTB-PROPOSTA.                                           
270904        09  WTB-PROPOSTAS      OCCURS    140.                     
CA2503         11 WTB-CD-PROPOSTA-ADP    PIC  9(010).                   
CA2503         11 WTB-NO-APROVACAO       PIC  9(011).                   
CA2503         11 WTB-NM-COMPLETO        PIC  X(060).                   
CA2503         11 WTB-CD-STATUS          PIC  X(002).                   
CA2503         11 WTB-NO-CPF-CGC         PIC  9(014).                   
CA2503         11 WTB-DT-INCLUSAO        PIC  9(008).                   
CA2503         11 WTB-DT-ULT-ATU         PIC  9(008).                   
270904         11 WTB-DT-CONF-CR         PIC  9(008).                   
CA2503         11 WTB-VL-FINANCIADO      PIC  9(13)V99.                 
050304         11 WTB-CD-INTERMED        PIC  9(006)  VALUE 0.          
050304         11 WTB-FPGTO              PIC  X(002)  VALUE ' '.        
050304         11 WTB-ID-IMPRES-DOCTO    PIC  9(002)  VALUE 0.          
      *                                                                 
       01          FILLER              PIC  X(05)  VALUE 'BOOKS'.       
      *                                                                 
      ****************************************************************  
      /                                                                 
      ***************************************************************** 
      * BOOK DO ARQUIVO ADPA061 (PROPOSTAS)                           * 
      ***************************************************************** 
121203    COPY ADPB061.                                                 
      *                                                                 
      ***************************************************************** 
      * BOOK DO ARQUIVO ADPA062 (PESSOA X PROPOSTA =TIT/CONJ/DEV1/DEV2* 
      ***************************************************************** 
121203    COPY ADPB062.                                                 
      *                                                                 
      ***************************************************************** 
      * BOOK DO ARQUIVO ADPA063 - GARANTIAS                           * 
      ***************************************************************** 
121203    COPY ADPB063.                                                 
      *                                                                 
      ***************************************************************** 
      * BOOK DO ARQUIVO ADPA004 - APROVACAO                           * 
      ***************************************************************** 
          COPY ADPB004.                                                 
      *                                                                 
      ***************************************************************** 
270904* BOOK DO ARQUIVO ADPA051 - CHECAGENS                           * 
270904***************************************************************** 
270904    COPY ADPB051.                                                 
      *                                                                 
      ***************************************************************** 
      * BOOK DO ARQUIVO TABA662 - TABELA DE FILIAIS                   * 
      ***************************************************************** 
          COPY TABB662.                                                 
      ***************************************************************** 
      * BOOK DE COMUNICACAO CONSULTA PROPOSTA                         * 
      ***************************************************************** 
           COPY VCRC080.                                                
      ***************************************************************** 
      *----------------------------------------------------------------*
      *-----> BOOK SERVICO STICR584 DESCRICAO OBJETO FINANCIADO <------*
      *----------------------------------------------------------------*
060204 COPY STIC584.                                                    
      *----------------------------------------------------------------*
      ***************************************************************** 
      * BOOK DE COMUNICACAO SUMARIZACAO PROPOSTAS POR STATUS          * 
      ***************************************************************** 
          COPY VCRC110.                                                 
      ***************************************************************** 
      *----------------------------------------------------------------*
      *-----> SERVICO PARA ACESSAR A TABELA TABA516                    *
      *----------------------------------------------------------------*
CD3969 COPY CIPC32I.                                                    
      *----------------------------------------------------------------*
      *-----> SERVICO PARA ACESSAR A TABELA TABA640                    *
      *----------------------------------------------------------------*
CD3969 COPY CIPC32R.                                                    
      *----------------------------------------------------------------*
      *-----> SERVICO PARA ACESSAR A TABELA TABA663                    *
      *----------------------------------------------------------------*
CD3969 COPY CIPC79I.                                                    
      *                                                                 
      ******************************************************************
      *  AREAS PARA ABEND                                              *
      ******************************************************************
       01       WS-AREA-ABEND          PIC  X(100).                     
      ******************************************************************
      *                                                                 
       01          FILLER              PIC  X(09)  VALUE 'FIM-WK'.      
      ******************************************************************
      /                                                                 
       LINKAGE                         SECTION.                         
      *                                                                 
050304 01          DFHCOMMAREA         PIC  X(24573).                   
      *                                                                 
      /                                                                 
       PROCEDURE        DIVISION.                                       
      ******************************************************************
      *                   PROCEDURE DIVISION                           *
      ******************************************************************
                                                                        
       010-00-LOGICA-PRINCIPAL         SECTION.                         
      ******************************************************************
      *              L O G I C A   P R I N C I P A L                   *
      ******************************************************************
                                                                        
                                                                        
           EXEC    CICS    HANDLE  ABEND                                
050304                     LABEL  (100-00-LOGA-ABEND)                   
           END-EXEC.                                                    
                                                                        
           PERFORM 020-00-INICIALIZA.                                   
                                                                        
           PERFORM 040-00-PROCESSA.                                     
                                                                        
           GO  TO  080-00-FINALIZA.                                     
                                                                        
       010-09-LOGICA-PRINCIPAL-FIM.                                     
           GOBACK.                                                      
      /                                                                 
       020-00-INICIALIZA               SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - ROTINA DE INICIALIZACAO DO PROGRAMA                         *
      ******************************************************************
      *                                                                 
121203     MOVE  WS-BIN-5F-2    TO    WS-BIN-1.                         
121203     MOVE  WS-BIN-FD-2    TO    WS-BIN-2.                         
      *                                                                 
           IF EIBCALEN   GREATER  ZEROS                                 
               MOVE  DFHCOMMAREA  TO  VCRC080-REG                       
           ELSE                                                         
               EXEC CICS  RECEIVE                                       
                          INTO (VCRC080-REG)                            
121203                    LENGTH (WS-BIN-24573)                         
                          END-EXEC                                      
           END-IF.                                                      
      *                                                                 
                                                                        
      **********INICIALIZA AREA DE SAIDA FIXA                           
                                                                        
           MOVE  ZEROS     TO   VCRC080-S-CD-RETORNO                    
                                VCRC080-S-COD-RETORNO-ACESSO.           
           MOVE  SPACES    TO   VCRC080-S-DS-RETORNO                    
                                VCRC080-S-TOT-PROPOSTAS.                
      *                                                                 
121203     MOVE SPACES TO  VCRC080-S-NM-COMPLETO-CONJ                   
121203                     VCRC080-S-NM-ORG-EMIS-CONJ                   
121203                     VCRC080-S-UF-ORG-EMIS-CONJ                   
121203                     VCRC080-S-CD-PAIS-DOC-CONJ                   
121203                     VCRC080-S-CD-NACIONALIDADE                   
121203                     VCRC080-S-NM-EMPRESA-CONJ                    
121203                     VCRC080-S-NO-DOC-CONJ                        
121203                     VCRC080-S-NM-COMPLETO-AVAL1                  
121203                     VCRC080-S-CD-TP-REPRES-AV1                   
121203                     VCRC080-S-NM-COMPLETO-AVAL2                  
121203                     VCRC080-S-CD-TP-REPRES-AV2                   
121203                     VCRC080-S-DS-PROFISSAO-CONJ                  
121203                     VCRC080-S-DS-RETORNO                         
121203                     VCRC080-S-DS-MARCA                           
121203                     VCRC080-S-DS-MODELO                          
121203                     VCRC080-S-DS-GARANTIA                        
121203                     VCRC080-S-ID-NOVO                            
121203                     VCRC080-S-TP-COMBUSTIVEL                     
121203                     VCRC080-S-NO-CHASSI-SERIE                    
121203                     VCRC080-S-NO-PLACA                           
121203                     VCRC080-S-DS-COR                             
121203                     VCRC080-S-IC-ADAPTADO                        
121203                     VCRC080-S-IC-TAXI.                           
      *                                                                 
           MOVE ZEROS TO   VCRC080-S-AGENC                              
                           VCRC080-S-SUBSEG                             
                           VCRC080-S-CD-LOJA                            
                           VCRC080-S-CD-VENDEDOR                        
                           VCRC080-S-DDD-LOJA                           
                           VCRC080-S-FONE-LOJA                          
                           VCRC080-S-DT-INCLUSAO                        
                           VCRC080-S-DT-APROVACAO                       
                           VCRC080-S-CD-PROPOSTA-ADP                    
                           VCRC080-S-CD-PROPOSTA-LFV                    
                           VCRC080-S-NO-APROVACAO                       
                           VCRC080-S-PRODT-ID                           
                           VCRC080-S-CD-CTX                             
                           VCRC080-S-VL-TX-ANO                          
                           VCRC080-S-VL-TX-ANO-ABN                      
                           VCRC080-S-VL-TX-MES                          
                           VCRC080-S-VL-IOF                             
                           VCRC080-S-VL-TAC                             
                           VCRC080-S-VL-TEC                             
                           VCRC080-S-DT-PRIM-VCTO                       
                           VCRC080-S-DT-TERMINO                         
                           VCRC080-S-QT-PRESTACAO                       
                           VCRC080-S-VL-FINANCIADO                      
                           VCRC080-S-VL-LIQUIDO                         
                           VCRC080-S-VL-ENTRADA                         
                           VCRC080-S-VL-PRESTACAO                       
                           VCRC080-S-VL-SEGURO                          
                           VCRC080-S-INDICE-CORRECAO                    
100603                     VCRC080-S-TIPO-LOGISTICA                     
                           VCRC080-S-CD-PESSOA                          
121203                     VCRC080-S-CD-EST-CIVIL                       
                           VCRC080-S-DT-NASC                            
                           VCRC080-S-GRAU-INSTRUCAO                     
                           VCRC080-S-NUM-END-RESID                      
                           VCRC080-S-CD-TP-RESID                        
121203                     VCRC080-S-ANO-RESID                          
121203                     VCRC080-S-MES-RESID                          
                           VCRC080-S-NO-DDD-TELEF-RES                   
                           VCRC080-S-NO-TELEF-RES                       
                           VCRC080-S-CD-TP-TELEF                        
                           VCRC080-S-NO-DDD-TEL-CEL                     
                           VCRC080-S-NO-TEL-CEL                         
                           VCRC080-S-CD-OCUPACAO                        
                           VCRC080-S-DT-TEMPO-ADMISSAO                  
                           VCRC080-S-VL-RENDA-MENSAL                    
                           VCRC080-S-VL-OUTRAS-RENDAS                   
                           VCRC080-S-NO-DDD-TELEF-COM                   
                           VCRC080-S-NO-TELEF-COM                       
                           VCRC080-S-NO-RAMAL-COM                       
                           VCRC080-S-CD-TP-TELEF-COM                    
121203                     VCRC080-S-NO-CPF-CGC-CONJ                    
                           VCRC080-S-DT-NASC-CONJ                       
121203                     VCRC080-S-TP-DOC-CONJ                        
121203                     VCRC080-S-DT-ORG-EMIS-CONJ                   
                           VCRC080-S-CD-OCUPACAO-CONJ                   
                           VCRC080-S-VL-RENDA-MES-CONJ                  
121203                     VCRC080-S-DT-ADMISSAO-CONJ                   
                           VCRC080-S-NO-DDD-COM-CONJ                    
                           VCRC080-S-NO-TEL-COM-CONJ                    
                           VCRC080-S-NO-RAMAL-COM-CONJ                  
                           VCRC080-S-VL-IMOVEL                          
                           VCRC080-S-VL-VEICULO                         
                           VCRC080-S-CD-BANCO                           
                           VCRC080-S-NO-CONTA-COR                       
                           VCRC080-S-NO-DDD-TEL-AGENC                   
                           VCRC080-S-NO-TEL-AGENC                       
                           VCRC080-S-NO-DDD-REF-1                       
                           VCRC080-S-NO-TEL-REF-1                       
                           VCRC080-S-NO-DDD-REF-2                       
                           VCRC080-S-NO-TEL-REF-2                       
                           VCRC080-S-VL-ATUAL                           
CA0904                     VCRC080-S-ANO-FABRICACAO                     
CA0904                     VCRC080-S-ANO-MODELO                         
                           VCRC080-S-NO-CPF-CGC-AV1                     
121203                     VCRC080-S-NO-CPF-CGC-AV2                     
                           VCRC080-S-CD-PESSOA-AV1                      
                           VCRC080-S-CD-PESSOA-AV2.                     
      *                                                                 
           PERFORM 020-10-ZERAR-OCOR-SAIDA                              
                   VARYING IN-ADP013   FROM   1 BY 1                    
270904             UNTIL   IN-ADP013   GREATER    140.                  
      *                                                                 
           PERFORM 030-00-VALIDA.                                       
      *                                                                 
       020-09-INICIALIZA-FIM. EXIT.                                     
      ******************************************************************
      /                                                                 
       020-10-ZERAR-OCOR-SAIDA         SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - ROTINA DE INICIALIZACAO DO PROGRAMA                         *
      ******************************************************************
                                                                        
           MOVE SPACES       TO                                         
050304                       VCRC080-S-FPGTO-OC       (IN-ADP013)       
                             VCRC080-S-CD-STATUS-OC   (IN-ADP013)       
                             VCRC080-S-NM-COMPLETO-OC (IN-ADP013).      
                                                                        
           MOVE  ZEROES      TO                                         
                             VCRC080-S-CD-PROPOSTA-ADP-OC (IN-ADP013)   
                             VCRC080-S-NO-CPF-CGC-OC  (IN-ADP013)       
                             VCRC080-S-NO-APROVACAO-OC    (IN-ADP013)   
                             VCRC080-S-DT-ULT-ATU-OC      (IN-ADP013)   
270904                       VCRC080-S-DT-CONF-CR-OC      (IN-ADP013)   
                             VCRC080-S-VL-FINANCIADO-OC   (IN-ADP013)   
050304                       VCRC080-S-CD-INTERMED-OC     (IN-ADP013)   
050304                       VCRC080-S-ID-IMPRES-DOCTO-OC (IN-ADP013)   
                             VCRC080-S-DT-INCLUSAO-OC (IN-ADP013).      
                                                                        
       020-19-ZERAR-OCOR-SAIDA-FIM. EXIT.                               
      ******************************************************************
      /                                                                 
       030-00-VALIDA                   SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - ROTINA DE VALIDACAO DAS AREAS DE ENTRADA                    *
      ******************************************************************
      *                                                                 
           IF      VCRC080-E-PESQUISA          EQUAL  SPACES     OR     
                                               LOW-VALUES               
                   MOVE  01  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'PARAMETROS DE-PESQUISA INVALIDOS'    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           IF      VCRC080-E-CRITERIO        NOT NUMERIC                
           OR      VCRC080-E-CRITERIO        NOT EQUAL                  
050304             ( 01  AND  02  AND  03  AND  21  AND  23 )           
                   MOVE  02  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'PARAMETRO:CRITERIO INVALIDO     '    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           IF      VCRC080-E-CD-PROPOSTA-ADP   NOT NUMERIC              
                   MOVE  03  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'PARAMETRO:CD-PROPOSTA INVALIDA  '    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           IF      VCRC080-E-CRITERIO       EQUAL  02                   
              IF   VCRC080-E-CD-PROPOSTA-ADP   EQUAL  ZEROS             
                   MOVE  04  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'PARAMETRO:CD-PROPOSTA ZERADA    '    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA                              
              ELSE                                                      
300304             MOVE  VCRC080-E-CRITERIO  TO  WS-E-CRITERIO          
                   GO    TO    030-99-VALIDA-FIM.                       
      *                                                                 
           IF      VCRC080-E-AGENC(1)          NOT NUMERIC              
             OR    VCRC080-E-AGENC(1)          EQUAL ZEROS              
             OR    VCRC080-E-SUBSEG(1)         NOT NUMERIC              
             OR    VCRC080-E-SUBSEG(1)         EQUAL ZEROS              
CA1908       OR    VCRC080-E-PRODT-ID(1)       NOT NUMERIC              
CA1908       OR    VCRC080-E-PRODT-ID(1)       EQUAL ZEROS              
             OR    VCRC080-E-CD-FIL-LOJA       NOT NUMERIC              
             OR    VCRC080-E-CD-INTERMEDIARIO  NOT NUMERIC              
             OR    VCRC080-E-CD-INTERMEDIARIO  EQUAL ZEROS              
                   MOVE  05  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'AG/SUB/PROD/LOJA/INTERM IMPR INVALIDO'   TO    
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
050304     IF      VCRC080-E-CRITERIO     EQUAL  21  OR  23             
050304       IF    VCRC080-E-DOC-IMPRESSO                               
050304                              NOT EQUAL ( 'S' AND 'N' )           
050304             MOVE  05  TO  VCRC080-S-CD-RETORNO                   
050304             MOVE 'DOC (S/N)  DOC IMPRESSO INVALIDO     '   TO    
050304                  VCRC080-S-DS-RETORNO                            
050304             GO  TO  080-00-FINALIZA.                             
      *                                                                 
050304     IF      VCRC080-E-CRITERIO     EQUAL  01  OR  03             
050304       IF    VCRC080-E-DOC-IMPRESSO NOT EQUAL ' '                 
050304             MOVE  05  TO  VCRC080-S-CD-RETORNO                   
050304             MOVE 'INTERMED / DOC IMPRESSO INVALIDO     '   TO    
050304                  VCRC080-S-DS-RETORNO                            
050304             GO  TO  080-00-FINALIZA.                             
      *                                                                 
           IF      VCRC080-E-SENTIDO-CONSULTA  NOT EQUAL  'A' AND 'P'   
                   MOVE  06  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'SENTIDO DE CONSULTA INVALIDO A/P'    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           IF      VCRC080-E-QTD-SOLICITADA    NOT NUMERIC              
           OR      VCRC080-E-QTD-SOLICITADA    LESS    001              
270904     OR      VCRC080-E-QTD-SOLICITADA    GREATER 140              
                   MOVE  07  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'QTDE.SOLICITADA INVALIDA        '    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           MOVE    VCRC080-E-QTD-SOLICITADA    TO  WS-OCOR-MAX.         
CA2503*****MOVE    VCRC080-E-QTD-SOLICITADA    TO  WS-IND-F.            
      *                                                                 
           IF      VCRC080-E-DT-INCL-INI       NOT NUMERIC              
           OR      VCRC080-E-DT-INCL-FIM       NOT NUMERIC              
                   MOVE  08  TO  VCRC080-S-CD-RETORNO                   
                   MOVE 'PERIODO (INI/FIM) INVALIDO(S)   '    TO        
                        VCRC080-S-DS-RETORNO                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
           PERFORM 030-00-05-DATAS.                                     
      *                                                                 
           PERFORM 030-00-07-FILIAIS.                                   
      *                                                                 
050304     IF  VCRC080-E-CRITERIO   EQUAL   03  OR  23                  
             PERFORM 030-00-20-SUMARIZA                                 
           END-IF.                                                      
      *                                                                 
      ***** PRESERVA O CRITERIO SOLICITADO. QDO. 21 FAZ IGUAL AO 01 ****
050304     MOVE    VCRC080-E-CRITERIO  TO  WS-E-CRITERIO.               
050304     IF      WS-E-CRITERIO  EQUAL  21  OR  03  OR  23             
050304         MOVE  01    TO   WS-E-CRITERIO                           
           END-IF.                                                      
      *                                                                 
CA2303     MOVE  VCRC080-E-SENTIDO-CONSULTA  TO  WS-SENTIDO-CONSULTA.   
      *                                                                 
           IF  WS-E-CRITERIO   EQUAL   01                               
              IF  VCRC080-E-CD-PROPOSTA-ADP   NOT EQUAL ZEROS           
                IF  VCRC080-E-CD-ULT-STATUS   NOT EQUAL SPACES          
CA2303                 MOVE  1   TO  WCH-OBTEM-IND                      
                       PERFORM 030-00-10-OBTEM-IND.                     
      *                                                                 
       030-99-VALIDA-FIM. EXIT.                                         
      **************************************************************    
      /                                                                 
       030-00-05-DATAS                 SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - CONSISTE DATA INICIAL E FINAL DO PERIODO A SER PESQUISADO   *
      ******************************************************************
      *                                                                 
      *----------------------------------------------------------------*
      *    ROTINA DE DATAS                                             *
      *----------------------------------------------------------------*
           MOVE  'H'                      TO  TOPER.                    
                                                                        
           EXEC   CICS  LINK  PROGRAM   ( '@DATA' )                     
                              COMMAREA  ( DATA-PARAM )                  
                              NOHANDLE                                  
           END-EXEC.                                                    
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
               MOVE  09  TO  VCRC080-S-CD-RETORNO                       
               MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO NO LINK DA ROTINA (@DATA)  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                *
           IF  RETCODE  NOT EQUAL ZEROES                                
               MOVE  10  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO AO OBTER A DATA DO DIA     '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      ************** DIA DE HOJE                                        
           MOVE  DATA1     TO   WS-DT-DMY.                              
           MOVE  WS-DIA-DMY     TO  WS-DIA-YMD.                         
           MOVE  WS-MES-DMY     TO  WS-MES-YMD.                         
           MOVE  WS-ANO-DMY     TO  WS-ANO-YMD.                         
           MOVE  WS-DT-YMD TO   WS-DT-COR.                              
      *                                                                 
      *                                                                 
           MOVE  '+'                      TO  TOPER.                    
           MOVE  ZEROS                    TO  FILIAL.                   
           MOVE  'S'                      TO  TCALC.                    
           MOVE  -31                      TO  DIFER.                    
           MOVE  'F'                      TO  TIPO1.                    
           MOVE  'F'                      TO  TIPO2.                    
      *                                                                 
           EXEC   CICS  LINK  PROGRAM   ( '@DATA' )                     
                              COMMAREA  ( DATA-PARAM )                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
               MOVE  11  TO  VCRC080-S-CD-RETORNO                       
               MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO NO LINK DA ROTINA (@DATA)  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
           IF  RETCODE  NOT EQUAL ZEROES                                
               MOVE  12  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO AO OBTER 1 MES ATRAS       '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *************  1 MES ATRAS                                        
           MOVE  DATA2     TO   WS-DT-DMY.                              
           MOVE  WS-DIA-DMY     TO  WS-DIA-YMD.                         
           MOVE  WS-MES-DMY     TO  WS-MES-YMD.                         
           MOVE  WS-ANO-DMY     TO  WS-ANO-YMD.                         
           MOVE  WS-DT-YMD TO   WS-DT-YMD-1.                            
      *                                                                 
       030-00-05-1-DT-INI.                                              
      *                                                                 
           IF  VCRC080-E-DT-INCL-INI  EQUAL  ZEROS                      
CA0104         MOVE WS-DT-YMD-1  TO  VCRC080-E-DT-INCL-INI              
               GO    TO    030-00-05-2-DT-FIM.                          
      *                                                                 
      *********  VERIFICA SE DATA INICIAL EH VALIDA                     
      *                                                                 
           INITIALIZE  DATA-PARAM.                                      
           MOVE  'C'                      TO  TOPER.                    
           MOVE  VCRC080-E-DT-INCL-INI    TO  WS-DT-YMD.                
           MOVE  WS-DIA-YMD               TO  WS-DIA-DMY.               
           MOVE  WS-MES-YMD               TO  WS-MES-DMY.               
           MOVE  WS-ANO-YMD               TO  WS-ANO-DMY.               
           MOVE  WS-DT-DMY                TO  DATA1.                    
      *                                                                 
           EXEC   CICS  LINK  PROGRAM   ( '@DATA' )                     
                              COMMAREA  ( DATA-PARAM )                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
               MOVE  13  TO  VCRC080-S-CD-RETORNO                       
               MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO NO LINK DA ROTINA (@DATA)  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
           IF  RETCODE  NOT EQUAL ZEROES                                
               MOVE  14  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'DATA INICIAL INVALIDA           '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      *********  VERIFICA SE DATA INICIAL EH ANTERIOR  A 1 MES          
      *                                                                 
           IF  VCRC080-E-DT-INCL-INI  LESS  WS-DT-YMD-1                 
               MOVE  15  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'DATA INICIAL ANTERIOR A 30 DIAS '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
       030-00-05-2-DT-FIM.                                              
      *                                                                 
           IF  VCRC080-E-DT-INCL-FIM  EQUAL  ZEROS                      
               MOVE  WS-DT-COR    TO   VCRC080-E-DT-INCL-FIM            
               GO    TO    030-00-05-99-FIM.                            
      *                                                                 
      *********  VERIFICA SE DATA FINAL EH VALIDA                       
      *                                                                 
           INITIALIZE  DATA-PARAM.                                      
           MOVE  'C'                      TO  TOPER.                    
           MOVE  VCRC080-E-DT-INCL-FIM    TO  WS-DT-YMD.                
           MOVE  WS-DIA-YMD               TO  WS-DIA-DMY.               
           MOVE  WS-MES-YMD               TO  WS-MES-DMY.               
           MOVE  WS-ANO-YMD               TO  WS-ANO-DMY.               
           MOVE  WS-DT-DMY                TO  DATA1.                    
      *                                                                 
           EXEC   CICS  LINK  PROGRAM   ( '@DATA' )                     
                              COMMAREA  ( DATA-PARAM )                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
               MOVE  16  TO  VCRC080-S-CD-RETORNO                       
               MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'ERRO NO LINK DA ROTINA (@DATA)  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
           IF  RETCODE  NOT EQUAL ZEROES                                
               MOVE  17  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'DATA FINAL INVALIDA             '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      *********  VERIFICA SE DATA FINAL EH MAIOR QUE HOJE               
      *                                                                 
           IF  VCRC080-E-DT-INCL-FIM  GREATER  WS-DT-COR                
               MOVE  18  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'DATA FINAL EH POSTERIOR A HOJE  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      *********  VERIFICA SE DATA FINAL EH ANTERIOR A INICIAL           
      *                                                                 
           IF  VCRC080-E-DT-INCL-FIM  LESS                              
                     VCRC080-E-DT-INCL-INI                              
               MOVE  19  TO  VCRC080-S-CD-RETORNO                       
               MOVE  RETCODE  TO  VCRC080-S-COD-RETORNO-ACESSO          
               MOVE 'DATA FINAL ANTERIOR A INICIAL   '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
       030-00-05-99-FIM.    EXIT.                                       
      ******************************************************************
      /                                                                 
       030-00-07-FILIAIS               SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - OBTER O O  CODIGO  DE FILIAL CORRESPONDENTE A BAIXA         *
      ******************************************************************
      *                                                                 
      * CONVERTER FILIAL/AGENCIA                                        
      *                                                                 
           MOVE  0   TO   WS-IND-FIL.                                   
      *                                                                 
       030-00-07-1-FIL.                                                 
      *                                                                 
           ADD   1   TO   WS-IND-FIL.                                   
           IF    WS-IND-FIL  GREATER  50                                
                 GO    TO    030-00-07-99-FIM.                          
      *                                                                 
           IF    VCRC080-E-AGENC(WS-IND-FIL)  NOT NUMERIC               
           OR    VCRC080-E-AGENC(WS-IND-FIL)  EQUAL ZEROS               
                 GO    TO    030-00-07-99-FIM.                          
      *                                                                 
090903 030-00-07-2-FIL.                                                 
      *                                                                 
010903     MOVE  SPACES  TO  RG-TABA662-662.                            
010903     MOVE  VCRC080-E-AGENC(WS-IND-FIL)  TO  ST-CHV-ARQ-662.       
010903*                                                                 
           EXEC  CICS  READ  FILE        (WS-A662)                      
                             INTO        (RG-TABA662-662)               
                             LENGTH      (WS-KEY-LEN-A662)              
                             RIDFLD      (ST-CHV-ARQ-662)               
                            NOHANDLE                                    
           END-EXEC                                                     
010903*                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
010903*                                                                 
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
            IF EIBRESP  NOT EQUAL DFHRESP(NOTFND)                       
               MOVE  20  TO  VCRC080-S-CD-RETORNO                       
               MOVE 'ERRO LEITURA TABA662 (FILIAIS)  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA                                  
            ELSE                                                        
               MOVE  21  TO  VCRC080-S-CD-RETORNO                       
               MOVE  VCRC080-E-AGENC(WS-IND-FIL) TO                     
                                     VCRC080-S-COD-RETORNO-ACESSO       
               MOVE 'NAO ACHOU FILIAL NO ARQ:TABA662 '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
090903*                                                                 
090903 030-00-07-3-FIL.                                                 
010903*                                                                 
010903      MOVE  CD-FILIAL-TAB-662 TO  VCRC080-E-AGENC(WS-IND-FIL).    
010903*                                                                 
090903 030-00-07-4-FIL.                                                 
            GO    TO    030-00-07-1-FIL.                                
      *                                                                 
       030-00-07-99-FIM.  EXIT.                                         
      **************************************************************    
      /                                                                 
       030-00-10-OBTEM-IND             SECTION.                         
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - OBTER O INDEXADOR PARA:                                     *
      *  1. LOJA (AGENC+SUBSEG)-> WS-IND-LOJA                          *
      *  1. STATUS -> WS-IND-STA                                       *
      *  AFIM DE PAGINAR AS OCORRENCIAS PARA A PLAT.BAIXA(INTERNET)    *
      ******************************************************************
      *                                                                 
           MOVE  0   TO   WS-IND-STA.                                   
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       030-00-10-1-STA.                                                 
      *                                                                 
           ADD   1   TO   WS-IND-STA.                                   
           IF  WS-IND-STA  NOT GREATER  20                              
             IF  VCRC080-E-CD-STATUS (WS-IND-STA)  EQUAL SPACES         
                 SUBTRACT    1   FROM   WS-IND-STA                      
             ELSE                                                       
             IF  VCRC080-E-CD-STATUS (WS-IND-STA)  EQUAL                
                                   VCRC080-E-CD-ULT-STATUS              
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  030-00-10-1-STA.                             
      *                                                                 
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               MOVE  22  TO  VCRC080-S-CD-RETORNO                       
               MOVE 'NAO ACHOU INDEXADOR IND-STATUS  '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      ****************  A ROTINA 040-00-10-A-START-LOJA JA SOMA 1       
CA2103     IF  WS-SENTIDO-CONSULTA      EQUAL  'P'                      
CA2103         SUBTRACT  1  FROM   WS-IND-STA                           
CA2103     ELSE                                                         
CA2103         ADD       1   TO    WS-IND-STA.                          
      *                                                                 
           MOVE  VCRC080-E-CD-PROPOSTA-ADP TO ADP061-CD-PROPOSTA-ADP.   
                                                                        
070808     EXEC  CICS  READ   FILE      ('ADPA061')                     
                              INTO      (ADP061-REG)                    
070808                        LENGTH    (LENGTH OF ADP061-REG)          
070808                        KEYLENGTH (LENGTH OF ADP061-CHAVE)        
                              RIDFLD    (ADP061-CHAVE)                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF EIBRESP NOT EQUAL ZEROS AND                               
              EIBRESP NOT EQUAL DFHRESP(NOTFND)                         
              MOVE  23            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO READ ADPP061 (IND-LOJA)      '                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF EIBRESP   EQUAL DFHRESP(NOTFND)                           
              MOVE  24            TO  VCRC080-S-CD-RETORNO              
              MOVE  'NAO ACHOU PROPOSTA (IND-LOJA)     '                
                                  TO  VCRC080-S-DS-RETORNO              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
CA1004****** P/MANTER A POSICAO DO ULTIMO STATUS LIDO DA PAGINA         
CA1004     MOVE  VCRC080-E-CD-ULT-STATUS  TO  ADP061-CD-STATUS.         
      ****** P/POSICIONAR NO START. CD-PROPOSTA JA ESTAH CARREGADO.     
CA2203     MOVE  ADP061-CHAVE-SEC      TO WCH-PROPOSTA-ANT.             
      *                                                                 
           MOVE  0   TO   WS-IND-SEG.                                   
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       030-00-10-2-SUBSEG.                                              
      *                                                                 
           ADD   1   TO   WS-IND-SEG.                                   
           IF  WS-IND-SEG   NOT GREATER  50                             
             IF  VCRC080-E-SUBSEG (WS-IND-SEG) NOT NUMERIC              
             OR  VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ZEROS              
                 SUBTRACT    1   FROM   WS-IND-SEG                      
             ELSE                                                       
             IF  VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ADP061-SUBSEG      
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  030-00-10-2-SUBSEG.                          
      *                                                                 
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               MOVE  25  TO  VCRC080-S-CD-RETORNO                       
               MOVE 'NAO ACHOU INDEXADOR IND-SEG     '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      ****************  A ROTINA 040-00-10-A-START-LOJA JA SOMA 1       
CA2103     IF  WS-SENTIDO-CONSULTA  EQUAL  'P'                          
               SUBTRACT  1  FROM   WS-IND-SEG                           
CA2103     ELSE                                                         
CA2103         ADD       1   TO    WS-IND-SEG.                          
      *                                                                 
           MOVE  0   TO   WS-IND-LOJA.                                  
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       030-00-10-3-LOJA.                                                
      *                                                                 
           ADD   1   TO   WS-IND-LOJA.                                  
           IF  WS-IND-LOJA  NOT GREATER  50                             
             IF  VCRC080-E-AGENC  (WS-IND-LOJA) NOT NUMERIC             
             OR  VCRC080-E-AGENC  (WS-IND-LOJA) EQUAL ZEROS             
                 SUBTRACT    1   FROM   WS-IND-LOJA                     
             ELSE                                                       
             IF  VCRC080-E-AGENC  (WS-IND-LOJA) EQUAL ADP061-AGENC      
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  030-00-10-3-LOJA.                            
      *                                                                 
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               MOVE  26  TO  VCRC080-S-CD-RETORNO                       
               MOVE 'NAO ACHOU INDEXADOR IND-LOJA    '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
      ****************  A ROTINA 040-00-10-A-START-LOJA JA SOMA 1       
CA2103     IF  WS-SENTIDO-CONSULTA  EQUAL  'P'                          
               SUBTRACT  1  FROM   WS-IND-LOJA                          
CA2103     ELSE                                                         
CA2103         ADD       1   TO    WS-IND-LOJA.                         
      *                                                                 
       030-00-10-99-FIM.  EXIT.                                         
      **************************************************************    
      /                                                                 
      **************************************************************    
       030-00-20-SUMARIZA       SECTION.                                
      ******************************************************************
      *                                                                 
           MOVE  VCRC080-E-CD-TRN-MF   TO  VCRC110-E-CD-TRN-MF.         
           MOVE  VCRC080-C-PADRAO-MCI  TO  VCRC110-C-PADRAO-MCI.        
           MOVE  VCRC080-E-NM-PGM-MF   TO  VCRC110-E-NM-PGM-MF.         
      *                                                                 
           MOVE  ZERO  TO  WS-IND-LOJA.                                 
      *                                                                 
       030-00-20-1-LOJA.                                                
      *                                                                 
           ADD   1     TO  WS-IND-LOJA.                                 
           IF    WS-IND-LOJA  NOT GREATER  50                           
                 MOVE  VCRC080-E-AGENC(WS-IND-LOJA)                     
                   TO  VCRC110-E-CD-AGENCIA(WS-IND-LOJA)                
                 MOVE  VCRC080-E-SUBSEG(WS-IND-LOJA)                    
                   TO  VCRC110-E-CD-SUB-SEG(WS-IND-LOJA)                
                 GO    TO    030-00-20-1-LOJA                           
           END-IF.                                                      
      *                                                                 
           MOVE  VCRC080-E-CD-INTERMEDIARIO                             
                 TO  VCRC110-E-CD-INTERMEDIARIO.                        
           MOVE  VCRC080-E-CD-FIL-LOJA                                  
                 TO  VCRC110-E-CD-FILIAL.                               
           MOVE  VCRC080-E-DT-INCL-INI                                  
                 TO  VCRC110-E-DT-INICIO.                               
           MOVE  VCRC080-E-DT-INCL-FIM                                  
                 TO  VCRC110-E-DT-FIM.                                  
           MOVE  VCRC080-E-TP-SUMARIZACAO                               
                 TO  VCRC110-E-TP-SUMARIZACAO.                          
CA1204     MOVE  VCRC080-E-NO-CPF-CGC                                   
CA1204           TO  VCRC110-E-NO-CPF-CGC.                              
100904     MOVE  VCRC080-E-DOC-IMPRESSO                                 
100904           TO  VCRC110-E-DOC-IMPRESSO.                            
      *                                                                 
           MOVE  ZERO  TO  WS-IND-STA.                                  
      *                                                                 
       030-00-20-2-STA.                                                 
      *                                                                 
           ADD   1     TO  WS-IND-STA.                                  
           IF    WS-IND-STA   NOT GREATER  20                           
                 MOVE  VCRC080-E-ST-PROPOSTA(WS-IND-STA)                
                   TO  VCRC110-E-ST-PROPOSTA(WS-IND-STA)                
                 GO    TO    030-00-20-2-STA.                           
      *                                                                 
CA1908 030-00-20-3-PROD.                                                
CA1908*                                                                 
CA1908     ADD   1     TO  WS-IND-PRD.                                  
CA1908     IF    WS-IND-PRD   NOT GREATER  10                           
CA1908           MOVE  VCRC080-E-PRODT-ID(WS-IND-PRD)                   
CA1908             TO  VCRC110-E-PRODT-ID(WS-IND-PRD)                   
CA1908           GO    TO    030-00-20-3-PROD.                          
      *                                                                 
       030-00-20-4-LINK.                                                
      *                                                                 
121203     EXEC   CICS  LINK  PROGRAM   ( 'ADPP04D' )                   
                              COMMAREA  ( VCRC110-REG )                 
                              LENGTH    ( LENGTH OF VCRC110-REG )       
                              SYNCONRETURN                              
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                *
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO              
      *                                                                *
      *                                                                 
           IF  EIBRESP  NOT EQUAL DFHRESP(NORMAL)                       
               MOVE  27  TO  VCRC080-S-CD-RETORNO                       
               MOVE 'ERRO LINK SUMARIZACAO (ADPP04D) '    TO            
                    VCRC080-S-DS-RETORNO                                
               GO  TO  080-00-FINALIZA.                                 
      *                                                                *
           IF  VCRC110-S-CD-RETORNO  NOT EQUAL  ZEROES                  
               MOVE  VCRC110-S-CD-RETORNO  TO  VCRC080-S-CD-RETORNO     
               MOVE  VCRC110-S-CD-RETORNO-ACESSO                        
                                  TO  VCRC080-S-COD-RETORNO-ACESSO      
               MOVE  VCRC110-S-DS-RETORNO  TO  VCRC080-S-DS-RETORNO     
               GO  TO  080-00-FINALIZA.                                 
      *                                                                 
CA2403     MOVE  ZERO  TO  WS-IND-LOJA  WS-IND-SEG  WS-IND-STA.         
           MOVE  VCRC110-S-TOT-PROPOSTAS  TO  VCRC080-S-TOT-PROPOSTAS.  
      *                                                                 
       030-00-20-99-EXIT.   EXIT.                                       
      ******************************************************************
      /                                                                 
      **************************************************************    
       040-00-PROCESSA          SECTION.                                
      ******************************************************************
      *                                                                 
           IF  WS-E-CRITERIO        EQUAL   02                          
               PERFORM 040-00-30-LER-ESPECIFICA                         
               GO    TO    040-00-PROCESSA-FIM.                         
      *                                                                 
      ******************************************************************
050304     IF  WS-E-CRITERIO        EQUAL   01                          
121203         IF  VCRC080-E-NO-CPF-CGC  NOT NUMERIC                    
121203         OR  VCRC080-E-NO-CPF-CGC  EQUAL ZEROES                   
                 IF    VCRC080-E-DT-INCL-INI EQUAL ZEROS                
                 AND   VCRC080-E-DT-INCL-FIM EQUAL ZEROS                
                     IF (VCRC080-E-CD-STATUS(1) EQUAL SPACES            
                     OR                              LOW-VALUES)        
                       MOVE  28  TO  VCRC080-S-CD-RETORNO               
                       MOVE 'CONSULTA SINTETICA SEM PARAMETRO'    TO    
                            VCRC080-S-DS-RETORNO                        
                       GO  TO  080-00-FINALIZA                          
                     ELSE                                               
050304                 MOVE  17  TO  WS-E-CRITERIO                      
                       PERFORM 040-00-10-SEL-PER-STA                    
                 ELSE                                                   
                     IF (VCRC080-E-CD-STATUS(1) EQUAL SPACES            
                      OR                          LOW-VALUES)           
050304                 MOVE  16  TO  WS-E-CRITERIO                      
                       PERFORM 040-00-10-SEL-PER-STA                    
                     ELSE                                               
050304                 MOVE  15  TO  WS-E-CRITERIO                      
                       PERFORM 040-00-10-SEL-PER-STA                    
               ELSE                                                     
                 IF    VCRC080-E-DT-INCL-INI EQUAL ZEROS                
                  AND  VCRC080-E-DT-INCL-FIM EQUAL ZEROS                
                 AND (VCRC080-E-CD-STATUS(1) EQUAL SPACES OR LOW-VALUES)
050304               MOVE  11  TO  WS-E-CRITERIO                        
CA1203               PERFORM 040-00-20-SEL-CPFN                         
                 ELSE                                                   
                 IF   VCRC080-E-DT-INCL-INI  NOT EQUAL ZEROS            
                  AND VCRC080-E-DT-INCL-FIM  NOT EQUAL ZEROS            
                 AND (VCRC080-E-CD-STATUS(1) EQUAL SPACES OR LOW-VALUES)
050304               MOVE  12  TO  WS-E-CRITERIO                        
CA1203               PERFORM 040-00-20-SEL-CPFN                         
                 ELSE                                                   
                 IF   VCRC080-E-DT-INCL-INI  NOT EQUAL ZEROS            
                  AND VCRC080-E-DT-INCL-FIM  NOT EQUAL ZEROS            
                  AND VCRC080-E-CD-STATUS(1) NOT EQUAL SPACES           
                                                 AND   LOW-VALUES       
050304               MOVE  13  TO  WS-E-CRITERIO                        
CA0804               PERFORM 040-00-10-SEL-PER-STA                      
                 ELSE                                                   
                 IF   VCRC080-E-DT-INCL-INI  EQUAL ZEROS                
                  AND VCRC080-E-DT-INCL-FIM  EQUAL ZEROS                
                  AND VCRC080-E-CD-STATUS(1) NOT EQUAL SPACES           
                                                 AND   LOW-VALUES       
050304               MOVE  14  TO  WS-E-CRITERIO                        
CA1203               PERFORM 040-00-20-SEL-CPFN.                        
      *                                                                 
       040-00-PROCESSA-FIM. EXIT.                                       
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-SEL-PER-STA        SECTION.                            
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - SELECIONAR SEQUENCIALMENTE ADPA061 (PROPOSTAS):             *
      *  CRITERIO   PESQUISANDO POR                                    *
      *  15  (PRI)  (PERIODO + STATUS)                                 *
      *  16  (PRI)  (PERIODO)                                          *
      *  17  (PRI)  (STATUS)                                           *
      ******************************************************************
      *                                                                 
CA2703**** MOVE  +0                    TO  WS-IND-S.                    
      *                                                                 
CA1203     MOVE  WS-IND-LOJA           TO  WS-IND-LOJA-AUX.             
CA1203     MOVE  WS-IND-SEG            TO  WS-IND-SEG-AUX.              
CA1203     MOVE  WS-IND-STA            TO  WS-IND-STA-AUX.              
      *                                                                 
       040-00-10-1-SEL.                                                 
      *                                                                 
CA2703     MOVE  +0                    TO  WS-IND-S.                    
CA2603     MOVE  WTB-FIL-PROPOSTA    TO    VCRC080-S-PROPOSTA.          
100904*****MOVE    SPACES       TO     ADP061-CHAVE-SEC.                
      *                                                                 
CA2203     IF  WS-SENTIDO-CONSULTA  EQUAL  'P'                          
CA2203         MOVE  'NEXT'    TO    WCH-BROWSE                         
CA2203     ELSE                                                         
CA2203         MOVE  'PREV'    TO    WCH-BROWSE                         
CA2203     END-IF.                                                      
050304     IF  WS-E-CRITERIO  EQUAL  16                                 
               PERFORM 040-00-10-B-SEL  UNTIL                           
                                    WS-IND-LOJA  GREATER  50            
           ELSE                                                         
CA0804*                    * CRITERIO 15 OU 17 OU 13                    
               PERFORM 040-00-10-A-SEL  UNTIL                           
                                    WS-IND-LOJA  GREATER  50.           
      *                                                                 
CA2703*****IF    WS-IND-S  GREATER  ZERO  SUBTRACT 1 FROM WS-IND-S.     
      *                                                                 
CA2203     IF    WS-IND-S    EQUAL  ZEROES                              
CA2203        IF  WS-SENTIDO-CONSULTA  EQUAL  'P'                       
CA2203            MOVE  'A'   TO    WS-SENTIDO-CONSULTA                 
CA2203        ELSE                                                      
CA2203            MOVE  'P'   TO    WS-SENTIDO-CONSULTA                 
CA2203        END-IF                                                    
CA2303        IF  WCH-INVERTE  EQUAL  0                                 
CA2203          MOVE  1  TO  WCH-INVERTE                                
CA2303          IF  WCH-OBTEM-IND  EQUAL  1                             
CA2203              PERFORM  030-00-10-OBTEM-IND                        
CA2303          END-IF                                                  
CA2203          GO    TO    040-00-10-1-SEL                             
CA2303        END-IF                                                    
CA2203     END-IF.                                                      
      *                                                                 
CA2203**   IF    WS-IND-S    EQUAL  ZEROES                              
CA2203**      IF  WCH-PESQ-PROX  EQUAL  'N'                             
CA2203**      OR  WCH-PESQ-ANT   EQUAL  'N'                             
CA2203**         MOVE  WS-IND-LOJA-AUX   TO  WS-IND-LOJA                
CA2203**         MOVE  WS-IND-SEG-AUX    TO  WS-IND-SEG                 
CA2203**         MOVE  WS-IND-STA-AUX    TO  WS-IND-STA                 
CA2203**         GO    TO    040-00-10-1-SEL.                           
      *                                                                 
       040-00-10-SEL-PER-STA-FIM.      EXIT.                            
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-A-SEL              SECTION.                            
      ******************************************************************
      *  FINALIDADE : QUANDO PESQUISA POR STATUS  OU   STATUS+PERIODO  *
      *  - FIXAR STATUS E VARIAR LOJA(AGENC+SUBSEG):                   *
      ******************************************************************
      *                                                                 
CA2203*                                                                 
CA2203     IF  WS-SENTIDO-CONSULTA  EQUAL  'A'                          
CA2203         PERFORM 040-00-10-X-SEL-ANTERIOR                         
CA2203         PERFORM 040-00-10-70-30-INVERTE                          
CA2203             MOVE  51    TO   WS-IND-LOJA                         
CA2203             GO    TO    040-00-10-A-99-FIM.                      
CA2203*                                                                 
       040-00-10-A-AGENC.                                               
      *                                                                 
             ADD   1     TO   WS-IND-LOJA                               
             IF    WS-IND-LOJA  GREATER  50                             
                   GO    TO    040-00-10-A-99-FIM                       
             END-IF.                                                    
             IF    VCRC080-E-AGENC (WS-IND-LOJA) EQUAL ZEROES           
                   MOVE  51    TO   WS-IND-LOJA                         
                   GO    TO    040-00-10-A-99-FIM                       
             END-IF.                                                    
      *                                                                 
       040-00-10-A-SUBSEG.                                              
      *                                                                 
               ADD   1     TO   WS-IND-SEG                              
               IF    WS-IND-SEG   GREATER  50                           
               OR    VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ZEROES         
                    MOVE  0    TO   WS-IND-SEG                          
                    MOVE  0    TO   WS-IND-STA                          
                    GO    TO    040-00-10-A-AGENC                       
               END-IF.                                                  
      *                                                                 
       040-00-10-A-STATUS.                                              
      *                                   * 16 = PERIODO                
050304     IF  WS-E-CRITERIO  EQUAL  16                                 
               MOVE  1     TO   WS-IND-STA                              
               GO    TO    040-00-10-A-START.                           
      *                                                                 
              ADD   1     TO   WS-IND-STA                               
              IF    WS-IND-STA   GREATER  20                            
              OR    VCRC080-E-CD-STATUS (WS-IND-STA) EQUAL SPACES       
              OR    VCRC080-E-CD-STATUS (WS-IND-STA) EQUAL LOW-VALUES   
                 MOVE  0    TO   WS-IND-STA                             
                 GO    TO    040-00-10-A-SUBSEG                         
              END-IF.                                                   
      *                                                                 
      ***************************************************************** 
       040-00-10-A-START.                                               
      *                                                                 
           MOVE  VCRC080-E-AGENC (WS-IND-LOJA) TO ADP061-AGENC.         
           MOVE  VCRC080-E-SUBSEG(WS-IND-SEG)  TO ADP061-SUBSEG.        
           MOVE  VCRC080-E-CD-STATUS(WS-IND-STA) TO ADP061-CD-STATUS.   
100904     IF  VCRC080-E-CD-INTERMEDIARIO  NOT EQUAL 999999             
100904         MOVE VCRC080-E-CD-INTERMEDIARIO TO ADP061-CD-LOJA.       
070808     MOVE  ' '                           TO ADP061-FILLER-01.     
      *                                                                 
CA2703     IF    WCH-INVERTE  EQUAL  1                                  
CA2703         MOVE  ZEROES              TO ADP061-DT-INCLUSAO          
CA2703         MOVE  ZEROES              TO ADP061-CD-PROPOSTA-ADP-2    
CA2703     ELSE                                                         
CA2803      IF WCH-QUEBRA-STA  EQUAL  0                                 
CA2703         MOVE  WCH-DT-INCLUSAO       TO ADP061-DT-INCLUSAO        
CA2703       MOVE VCRC080-E-CD-PROPOSTA-ADP TO ADP061-CD-PROPOSTA-ADP-2 
CA2803         ADD         1               TO ADP061-CD-PROPOSTA-ADP-2  
CA2703      ELSE                                                        
CA2703         MOVE  ZEROES              TO ADP061-DT-INCLUSAO          
CA2703         MOVE  ZEROES              TO ADP061-CD-PROPOSTA-ADP-2    
CA2703      END-IF                                                      
CA2703     END-IF.                                                      
      *                                                                 
           PERFORM 040-00-10-10-START-LOJA.                             
      *                                                                 
           IF    EIBRESP EQUAL DFHRESP (NOTFND)                         
                 GO    TO    040-00-10-A-SUBSEG.                        
      *                                                                 
       040-00-10-A-LER.                                                 
      *                                                                 
070808        EXEC  CICS READNEXT FILE('ADPP061')                       
070808                       LENGTH(LENGTH OF ADP061-REG)               
                               INTO(ADP061-REG)                         
                             RIDFLD(ADP061-CHAVE-SEC)                   
                           NOHANDLE                                     
              END-EXEC                                                  
      *                                                                 
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
      *                                                                 
           IF    EIBRESP  NOT EQUAL DFHRESP(NORMAL)                     
            IF  EIBRESP  NOT EQUAL DFHRESP(DUPKEY)                      
             IF  EIBRESP  EQUAL DFHRESP(ENDFILE)                        
                   PERFORM 040-00-10-30-END-STRT                        
                   MOVE  51    TO   WS-IND-LOJA                         
                   GO    TO    040-00-10-A-99-FIM                       
             ELSE                                                       
                   MOVE  29            TO  VCRC080-S-CD-RETORNO         
                   MOVE  'ERRO: READ NEXT ADPA061 - CHV.SEC '           
                                  TO  VCRC080-S-DS-RETORNO              
                   PERFORM 100-00-LOGA-ABEND                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
             IF  ADP061-AGENC  NOT  EQUAL                               
                               VCRC080-E-AGENC (WS-IND-LOJA)            
                 PERFORM 040-00-10-30-END-STRT                          
                 MOVE  0    TO   WS-IND-SEG                             
                 MOVE  0    TO   WS-IND-STA                             
               GO    TO    040-00-10-A-AGENC                            
             END-IF.                                                    
      *                                                                 
             IF  ADP061-SUBSEG NOT EQUAL                                
                               VCRC080-E-SUBSEG(WS-IND-SEG)             
                 PERFORM 040-00-10-30-END-STRT                          
                 MOVE  0    TO   WS-IND-STA                             
                 GO    TO    040-00-10-A-SUBSEG                         
CA2103       END-IF.                                                    
      *                                                                 
CA2603       IF  ADP061-CD-STATUS  NOT EQUAL                            
                                   VCRC080-E-CD-STATUS(WS-IND-STA)      
      ********* STARTA O PROXIMO STATUS                                 
                  PERFORM 040-00-10-30-END-STRT                         
CA2803            MOVE  1    TO    WCH-QUEBRA-STA                       
                  GO    TO    040-00-10-A-STATUS.                       
      *                                                                 
050304     IF  VCRC080-E-CD-INTERMEDIARIO NOT EQUAL 999999              
CA2603        IF  ADP061-CD-LOJA    NOT EQUAL                           
                               VCRC080-E-CD-INTERMEDIARIO               
      ********* STARTA O PROXIMO STATUS                                 
                  PERFORM 040-00-10-30-END-STRT                         
CA2803            MOVE  1    TO    WCH-QUEBRA-STA                       
                  GO    TO    040-00-10-A-STATUS.                       
      *                                                                 
080404     IF  ADP061-IC-CANAL-CAP  NOT EQUAL  01 AND 02                
080404********* DESPREZA E LE O SEGUINTE                                
080404          GO    TO    040-00-10-A-LER.                            
      *                                                                 
050304     IF  WS-E-CRITERIO EQUAL 15  OR  13                           
             IF  ADP061-DT-INCLUSAO GREATER                             
                               VCRC080-E-DT-INCL-FIM                    
      ********* STARTA O PROXIMO STATUS                                 
                  PERFORM 040-00-10-30-END-STRT                         
CA0404            MOVE  1    TO    WCH-QUEBRA-STA                       
                  GO    TO    040-00-10-A-STATUS                        
             ELSE                                                       
             IF  ADP061-DT-INCLUSAO LESS                                
                               VCRC080-E-DT-INCL-INI                    
      ********* DESPREZA E LE O SEGUINTE                                
                GO    TO    040-00-10-A-LER.                            
      *                                                                 
050403     IF  WS-E-CRITERIO EQUAL  13                                  
CA0804       AND  ADP061-NO-CPF-CGC   NOT EQUAL  VCRC080-E-NO-CPF-CGC   
      ********* DESPREZA E LE O SEGUINTE                                
CA0804          GO    TO    040-00-10-A-LER.                            
      *                                                                 
070808*----------------------------------------------------------------*
070808*---->    CAMPO INDICATIVO DE IMPRESSAO TIRADO NA EXPANSAO  <----*
070808*----------------------------------------------------------------*
070808************************************** SUPORG / FORMALIZACAO      
070808*      IF  VCRC080-E-CRITERIO  EQUAL  21  OR  23                  
070808*        IF  VCRC080-E-DOC-IMPRESSO  EQUAL  'S'                   
070808*          IF  ADP061-ID-IMPRES-DOCTO  EQUAL  00                  
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-A-LER                       
070808*          END-IF                                                 
070808*        ELSE                                                     
070808*          IF  ADP061-ID-IMPRES-DOCTO  NOT EQUAL  00              
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-A-LER                       
070808*          END-IF                                                 
070808*        END-IF                                                   
070808*      END-IF.                                                    
070808*                                                                 
CA1908     MOVE  0   TO   WS-IND-PRD.                                   
CA1908     MOVE  0   TO   WCH-ACHOU.                                    
CA1908*                                                                 
CA1908 040-00-10-A-PROD.                                                
CA1908*                                                                 
CA1908     ADD   1   TO   WS-IND-PRD.                                   
CA1908     IF  WS-IND-PRD   NOT GREATER  10                             
CA1908       IF  VCRC080-E-PRODT-ID (WS-IND-PRD) NOT NUMERIC            
CA1908       OR  VCRC080-E-PRODT-ID (WS-IND-PRD) EQUAL ZEROS            
CA1908           SUBTRACT    1   FROM   WS-IND-PRD                      
CA1908       ELSE                                                       
CA1908       IF  VCRC080-E-PRODT-ID (WS-IND-PRD) EQUAL ADP061-PRODT-ID  
CA1908           MOVE  1   TO   WCH-ACHOU                               
CA1908       ELSE                                                       
CA1908           GO    TO  040-00-10-A-PROD.                            
CA1908*                                                                 
CA1908     IF  WCH-ACHOU  EQUAL  ZERO                                   
CA1908********* DESPREZA E LE O SEGUINTE                                
CA1908          GO    TO    040-00-10-A-LER.                            
      *                                                                 
           ADD    1                    TO WS-IND-S.                     
           IF    WS-IND-S   GREATER  WS-OCOR-MAX                        
                 PERFORM 040-00-10-30-END-STRT                          
                 MOVE  51    TO   WS-IND-LOJA                           
                 GO    TO    040-00-10-A-99-FIM.                        
      *                                                                 
CA2803     MOVE  0    TO    WCH-QUEBRA-STA.                             
      *                                                                 
           MOVE  ADP061-CD-PROPOSTA-ADP   TO   ADP062-CD-PROPOSTA-ADP.  
           MOVE  01                       TO   ADP062-CD-PESSOA.        
           PERFORM 040-00-30-10-2-LER-PESSOAIS.                         
      *                                                                 
           MOVE  ADP061-CHAVE            TO  ADP004-CHAVE-SEC.          
           PERFORM  040-00-30-30-LER-APROV.                             
      *                                                                 
290704     PERFORM  040-00-20-20-10-1-DATA-CHEC.                        
      *                                                                 
           PERFORM 040-00-10-70-10-MOVE-OCOR.                           
      *                                                                 
      *********     LE O SEGUINTE                                       
           GO    TO    040-00-10-A-LER.                                 
      **************************************                            
      *                                                                 
       040-00-10-A-99-FIM.     EXIT.                                    
      ******************************************************************
      /                                                                 
      ******************************************************************
CA2203 040-00-10-X-SEL-ANTERIOR     SECTION.                            
CA2203******************************************************************
CA2203*  FINALIDADE : QUANDO PESQUISA POR STATUS  OU   STATUS+PERIODO  *
CA2203*  - FIXAR STATUS E VARIAR LOJA(AGENC+SUBSEG):                   *
CA2203******************************************************************
CA2203*                                                                 
CA2203     MOVE  WCH-PROPOSTA-ANT              TO ADP061-CHAVE-SEC.     
CA2203*                                                                 
CA2203     PERFORM 040-00-10-10-START-LOJA.                             
CA2203*                                                                 
CA2203     IF    EIBRESP EQUAL DFHRESP (NOTFND)                         
CA2203           MOVE  51    TO   WS-IND-LOJA                           
CA2203           GO    TO    040-00-10-X-99-FIM.                        
CA2203*                                                                 
CA2203 040-00-10-X-LER.                                                 
CA2203*                                                                 
070808        EXEC  CICS READPREV  FILE('ADPP061')                      
070808                       LENGTH(LENGTH OF ADP061-REG)               
CA2203                         INTO(ADP061-REG)                         
CA2203                       RIDFLD(ADP061-CHAVE-SEC)                   
CA2203                     NOHANDLE                                     
CA2203        END-EXEC                                                  
CA2203*                                                                 
CA2203     MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
CA2203*                                                                 
CA2203     IF    EIBRESP  NOT EQUAL DFHRESP(NORMAL)                     
CA2203      IF  EIBRESP  NOT EQUAL DFHRESP(DUPKEY)                      
CA2203       IF  EIBRESP  EQUAL DFHRESP(ENDFILE)                        
CA2203             PERFORM 040-00-10-30-END-STRT                        
CA2203             MOVE  51    TO   WS-IND-LOJA                         
CA2203             GO    TO    040-00-10-X-99-FIM                       
CA2203       ELSE                                                       
CA2203             MOVE  30            TO  VCRC080-S-CD-RETORNO         
CA2203             MOVE  'ERRO: READ NEXT ADPA061 - CHV.SEC '           
CA2203                            TO  VCRC080-S-DS-RETORNO              
CA2203             PERFORM 100-00-LOGA-ABEND                            
CA2203             GO  TO  080-00-FINALIZA.                             
CA2203*                                                                 
CA2203********* MAURICIO MAZON INFORMOU QUE TERA APENAS 1 AGENCIA       
CA2203       IF  ADP061-AGENC  NOT  EQUAL                               
CA2203                         VCRC080-E-AGENC (1)                      
CA2203            PERFORM 040-00-10-30-END-STRT                         
CA2203             MOVE  51    TO   WS-IND-LOJA                         
CA2203             GO    TO    040-00-10-X-99-FIM                       
CA2203       END-IF.                                                    
CA2203*                                                                 
CA2203       IF  ADP061-SUBSEG      LESS                                
CA2203                         VCRC080-E-SUBSEG (1)                     
CA2203            PERFORM 040-00-10-30-END-STRT                         
CA2203             MOVE  51    TO   WS-IND-LOJA                         
CA2203             GO    TO    040-00-10-X-99-FIM                       
CA2203       END-IF.                                                    
CA2203*                                                                 
           MOVE  0   TO   WS-IND-STA.                                   
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       040-00-10-1-STA.                                                 
      *                                                                 
           ADD   1   TO   WS-IND-STA.                                   
           IF  WS-IND-STA  NOT GREATER  20                              
             IF  VCRC080-E-CD-STATUS (WS-IND-STA)  EQUAL SPACES         
                 SUBTRACT    1   FROM   WS-IND-STA                      
             ELSE                                                       
             IF  VCRC080-E-CD-STATUS (WS-IND-STA)  EQUAL                
                                   ADP061-CD-STATUS                     
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  040-00-10-1-STA.                             
      *                                                                 
           IF  WCH-ACHOU  EQUAL  ZERO                                   
CA2203********* DESPREZA E LE O SEGUINTE                                
CA2203          GO    TO    040-00-10-X-LER.                            
      *                                                                 
           MOVE  0   TO   WS-IND-SEG.                                   
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       040-00-10-2-SUBSEG.                                              
      *                                                                 
           ADD   1   TO   WS-IND-SEG.                                   
           IF  WS-IND-SEG   NOT GREATER  50                             
             IF  VCRC080-E-SUBSEG (WS-IND-SEG) NOT NUMERIC              
             OR  VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ZEROS              
                 SUBTRACT    1   FROM   WS-IND-SEG                      
             ELSE                                                       
             IF  VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ADP061-SUBSEG      
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  040-00-10-2-SUBSEG.                          
      *                                                                 
           IF  WCH-ACHOU  EQUAL  ZERO                                   
CA2203********* DESPREZA E LE O SEGUINTE                                
CA2203          GO    TO    040-00-10-X-LER.                            
      *                                                                 
080404     IF  ADP061-IC-CANAL-CAP  NOT EQUAL  01 AND 02                
080404********* DESPREZA E LE O SEGUINTE                                
080404          GO    TO    040-00-10-X-LER.                            
      *                                                                 
050304     IF  VCRC080-E-CD-INTERMEDIARIO NOT EQUAL 999999              
CA2603        IF  ADP061-CD-LOJA    NOT EQUAL                           
                               VCRC080-E-CD-INTERMEDIARIO               
CA2203********* DESPREZA E LE O SEGUINTE                                
CA2203          GO    TO    040-00-10-X-LER.                            
      *                                                                 
050304     IF  WS-E-CRITERIO EQUAL 15  OR  13                           
CA2203       IF  ADP061-DT-INCLUSAO GREATER                             
CA2203                         VCRC080-E-DT-INCL-FIM                    
CA2203       OR  ADP061-DT-INCLUSAO LESS                                
CA2203                         VCRC080-E-DT-INCL-INI                    
CA2203********* DESPREZA E LE O SEGUINTE                                
CA2203          GO    TO    040-00-10-X-LER.                            
CA2203*                                                                 
      *                                                                 
050304     IF  WS-E-CRITERIO EQUAL  13                                  
CA0804       AND  ADP061-NO-CPF-CGC   NOT EQUAL  VCRC080-E-NO-CPF-CGC   
      ********* DESPREZA E LE O SEGUINTE                                
CA0804          GO    TO    040-00-10-X-LER.                            
      *                                                                 
CA1908*                                                                 
CA1908     MOVE  0   TO   WS-IND-PRD.                                   
CA1908     MOVE  0   TO   WCH-ACHOU.                                    
CA1908*                                                                 
CA1908 040-00-10-3-PROD.                                                
CA1908*                                                                 
CA1908     ADD   1   TO   WS-IND-PRD.                                   
CA1908     IF  WS-IND-PRD   NOT GREATER  10                             
CA1908       IF  VCRC080-E-PRODT-ID (WS-IND-PRD) NOT NUMERIC            
CA1908       OR  VCRC080-E-PRODT-ID (WS-IND-PRD) EQUAL ZEROS            
CA1908           SUBTRACT    1   FROM   WS-IND-PRD                      
CA1908       ELSE                                                       
CA1908       IF  VCRC080-E-PRODT-ID (WS-IND-PRD) EQUAL ADP061-PRODT-ID  
CA1908           MOVE  1   TO   WCH-ACHOU                               
CA1908       ELSE                                                       
CA1908           GO    TO  040-00-10-3-PROD.                            
CA1908*                                                                 
CA1908     IF  WCH-ACHOU  EQUAL  ZERO                                   
CA1908********* DESPREZA E LE O SEGUINTE                                
CA1908          GO    TO    040-00-10-X-LER.                            
CA1908*                                                                 
070808*----------------------------------------------------------------*
070808*---->    CAMPO INDICATIVO DE IMPRESSAO TIRADO NA EXPANSAO  <----*
070808*----------------------------------------------------------------*
070808************************************** SUPORG / FORMALIZACAO      
070808*      IF  VCRC080-E-CRITERIO  EQUAL  21  OR  23                  
070808*        IF  VCRC080-E-DOC-IMPRESSO  EQUAL  'S'                   
070808*          IF  ADP061-ID-IMPRES-DOCTO  EQUAL  00                  
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-X-LER                       
070808*          END-IF                                                 
070808*        ELSE                                                     
070808*          IF  ADP061-ID-IMPRES-DOCTO  NOT EQUAL  00              
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-X-LER                       
070808*          END-IF                                                 
070808*        END-IF                                                   
070808*      END-IF.                                                    
070808*                                                                 
CA2203     ADD    1                    TO WS-IND-S.                     
CA2203     IF    WS-IND-S   GREATER  WS-OCOR-MAX                        
CA2203           PERFORM 040-00-10-30-END-STRT                          
CA2203           MOVE  51    TO   WS-IND-LOJA                           
CA2203           GO    TO    040-00-10-X-99-FIM.                        
CA2203*                                                                 
CA2203     MOVE  ADP061-CD-PROPOSTA-ADP   TO   ADP062-CD-PROPOSTA-ADP.  
CA2203     MOVE  01                       TO   ADP062-CD-PESSOA.        
CA2203     PERFORM 040-00-30-10-2-LER-PESSOAIS.                         
CA2203*                                                                 
CA2203     MOVE  ADP061-CHAVE            TO  ADP004-CHAVE-SEC.          
CA2203     PERFORM  040-00-30-30-LER-APROV.                             
CA2203*                                                                 
290704     PERFORM  040-00-20-20-10-1-DATA-CHEC.                        
      *                                                                 
CA2203     PERFORM 040-00-10-70-20-MOVE-OCOR.                           
CA2203*                                                                 
CA2203*********     LE O SEGUINTE                                       
CA2203     GO    TO    040-00-10-X-LER.                                 
CA2203**************************************                            
CA2203*                                                                 
CA2203 040-00-10-X-99-FIM.     EXIT.                                    
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-B-SEL              SECTION.                            
      ******************************************************************
      *  FINALIDADE :  QUANDO A PESQUISA FOR APENAS POR PERIODO        *
      *  -           VARIAR LOJA(AGENC+SUBSEG), INDEPENDE DO STATUS    *
      ******************************************************************
      *                                                                 
       040-00-10-B-AGENC.                                               
      *                                                                 
           ADD   1     TO   WS-IND-LOJA.                                
           IF    WS-IND-LOJA  GREATER  50                               
                 GO    TO    040-00-10-B-99-FIM.                        
           IF    VCRC080-E-AGENC (WS-IND-LOJA) EQUAL ZEROES             
                 MOVE  51    TO   WS-IND-LOJA                           
                 GO    TO    040-00-10-B-99-FIM.                        
      *                                                                 
       040-00-10-B-SUBSEG.                                              
      *                                                                 
           ADD   1     TO   WS-IND-SEG.                                 
           IF    WS-IND-SEG   GREATER  50                               
           OR    VCRC080-E-SUBSEG (WS-IND-SEG) EQUAL ZEROES             
                 MOVE  0    TO   WS-IND-SEG                             
                 GO    TO    040-00-10-B-AGENC.                         
      *                                                                 
           MOVE  VCRC080-E-AGENC (WS-IND-LOJA) TO ADP061-AGENC.         
           MOVE  VCRC080-E-SUBSEG(WS-IND-SEG)  TO ADP061-SUBSEG.        
           MOVE  VCRC080-E-CD-STATUS(1)          TO ADP061-CD-STATUS.   
100904     IF  VCRC080-E-CD-INTERMEDIARIO NOT EQUAL 999999              
050304         MOVE VCRC080-E-CD-INTERMEDIARIO TO ADP061-CD-LOJA.       
070808     MOVE  ' '                           TO ADP061-FILLER-01.     
           MOVE  VCRC080-E-DT-INCL-INI         TO ADP061-DT-INCLUSAO.   
           MOVE  VCRC080-E-CD-PROPOSTA-ADP TO ADP061-CD-PROPOSTA-ADP-2. 
      *                                                                 
           PERFORM 040-00-10-10-START-LOJA.                             
      *                                                                 
           IF    EIBRESP EQUAL DFHRESP (NOTFND)                         
                 GO    TO    040-00-10-B-SUBSEG.                        
      *                                                                 
       040-00-10-B-LER.                                                 
      *                                                                 
           IF  WCH-BROWSE  EQUAL  'NEXT'                                
                                                                        
070808       EXEC  CICS READNEXT FILE('ADPP061')                        
070808                       LENGTH(LENGTH OF ADP061-REG)               
                               INTO(ADP061-REG)                         
                             RIDFLD(ADP061-CHAVE-SEC)                   
                           NOHANDLE                                     
             END-EXEC                                                   
           ELSE                                                         
070808       EXEC  CICS READPREV FILE('ADPP061')                        
070808                       LENGTH(LENGTH OF ADP061-REG)               
                               INTO(ADP061-REG)                         
                             RIDFLD(ADP061-CHAVE-SEC)                   
                           NOHANDLE                                     
             END-EXEC                                                   
           END-IF.                                                      
      *                                                                 
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
      *                                                                 
           IF    EIBRESP  NOT EQUAL DFHRESP(NORMAL)                     
            IF  EIBRESP  NOT EQUAL DFHRESP(DUPKEY)                      
             IF  EIBRESP  EQUAL DFHRESP(ENDFILE)                        
                   PERFORM 040-00-10-30-END-STRT                        
                   MOVE  51    TO   WS-IND-LOJA                         
                   GO    TO    040-00-10-B-99-FIM                       
             ELSE                                                       
                   MOVE  31            TO  VCRC080-S-CD-RETORNO         
                   MOVE  'ERRO: READ NEXT ADPA061 - CHV.SEC '           
                                  TO  VCRC080-S-DS-RETORNO              
                   PERFORM 100-00-LOGA-ABEND                            
                   GO  TO  080-00-FINALIZA.                             
      *                                                                 
             IF  ADP061-AGENC  NOT  EQUAL                               
                               VCRC080-E-AGENC (WS-IND-LOJA)            
                 PERFORM 040-00-10-30-END-STRT                          
                 MOVE  0    TO   WS-IND-SEG                             
                 GO    TO    040-00-10-B-AGENC.                         
      *                                                                 
             IF  ADP061-SUBSEG NOT EQUAL                                
                               VCRC080-E-SUBSEG(WS-IND-SEG)             
                 PERFORM 040-00-10-30-END-STRT                          
                 GO    TO    040-00-10-B-SUBSEG.                        
      *                                                                 
080404     IF  ADP061-IC-CANAL-CAP  NOT EQUAL  01 AND 02                
080404********* DESPREZA E LE O SEGUINTE                                
080404          GO    TO    040-00-10-B-LER.                            
      *                                                                 
050304     IF  VCRC080-E-CD-INTERMEDIARIO NOT EQUAL 999999              
CA2603        IF  ADP061-CD-LOJA    NOT EQUAL                           
                               VCRC080-E-CD-INTERMEDIARIO               
CA2203********* DESPREZA E LE O SEGUINTE                                
CA2203          GO    TO    040-00-10-B-LER.                            
      *                                                                 
             IF  ADP061-DT-INCLUSAO GREATER                             
                               VCRC080-E-DT-INCL-FIM                    
             OR  ADP061-DT-INCLUSAO LESS                                
                               VCRC080-E-DT-INCL-INI                    
      ********* DESPREZA E LE O SEGUINTE                                
                GO    TO    040-00-10-B-LER.                            
      *                                                                 
070808*----------------------------------------------------------------*
070808*---->    CAMPO INDICATIVO DE IMPRESSAO TIRADO NA EXPANSAO  <----*
070808*----------------------------------------------------------------*
070808************************************** SUPORG / FORMALIZACAO      
070808*      IF  VCRC080-E-CRITERIO  EQUAL  21  OR  23                  
070808*        IF  VCRC080-E-DOC-IMPRESSO  EQUAL  'S'                   
070808*          IF  ADP061-ID-IMPRES-DOCTO  EQUAL  00                  
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-B-LER                       
070808*          END-IF                                                 
070808*        ELSE                                                     
070808*          IF  ADP061-ID-IMPRES-DOCTO  NOT EQUAL  00              
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-10-B-LER                       
070808*          END-IF                                                 
070808*        END-IF                                                   
070808*      END-IF.                                                    
070804*                                                                 
           ADD    1                    TO WS-IND-S.                     
           IF      WS-IND-S   GREATER  WS-OCOR-MAX                      
                 PERFORM 040-00-10-30-END-STRT                          
                 MOVE  51    TO   WS-IND-LOJA                           
                 GO    TO    040-00-10-B-99-FIM.                        
      *                                                                 
           MOVE  ADP061-CD-PROPOSTA-ADP   TO   ADP062-CD-PROPOSTA-ADP.  
           MOVE  01                       TO   ADP062-CD-PESSOA.        
           PERFORM 040-00-30-10-2-LER-PESSOAIS.                         
      *                                                                 
           MOVE  ADP061-CHAVE            TO  ADP004-CHAVE-SEC.          
           PERFORM  040-00-30-30-LER-APROV.                             
      *                                                                 
290704     PERFORM  040-00-20-20-10-1-DATA-CHEC.                        
      *                                                                 
           PERFORM 040-00-10-70-10-MOVE-OCOR.                           
      *                                                                 
      *********     LE O SEGUINTE                                       
           GO    TO    040-00-10-B-LER.                                 
      **************************************                            
      *                                                                 
       040-00-10-B-99-FIM.     EXIT.                                    
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-10-START-LOJA               SECTION.                   
      ******************************************************************
CA1203******************************************************************
CA1203* FINALIDADE: POSICIONA P/ LER PROXIMO OU ANTERIOR, ONDE:        *
CA1203******************************************************************
      *                                                                 
      *                                                                 
           EXEC  CICS  STARTBR FILE('ADPP061')                          
                             RIDFLD(ADP061-CHAVE-SEC)                   
070808                   KEYLENGTH (LENGTH OF ADP061-CHAVE-SEC)         
                             GTEQ                                       
                           NOHANDLE                                     
           END-EXEC                                                     
                                                                        
           MOVE  EIBRESP TO VCRC080-S-COD-RETORNO-ACESSO.               
      *                                                                 
           IF    EIBRESP EQUAL DFHRESP (NOTFND)                         
                 GO  TO  040-00-10-10-START-FIM.                        
      *                                                                 
           IF    EIBRESP NOT EQUAL   ZEROS                              
              MOVE  32            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: STARTBR   ADPA061 - CHV.SEC.'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
      *****************  SE LEITURA ANTERIOR(PREV), LE O SEG. + ANT.    
           IF     WCH-BROWSE   EQUAL   'NEXT'                           
             GO    TO    040-00-10-10-START-FIM                         
           END-IF.                                                      
      *                                                                 
070808     EXEC  CICS READNEXT FILE('ADPP061')                          
070808                       LENGTH(LENGTH OF ADP061-REG)               
                               INTO(ADP061-REG)                         
                             RIDFLD(ADP061-CHAVE-SEC)                   
                           NOHANDLE                                     
           END-EXEC                                                     
      *                                                                 
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
      *                                                                 
             IF  EIBRESP      EQUAL DFHRESP (NOTFND)                    
             OR  EIBRESP      EQUAL DFHRESP (ENDFILE)                   
                 GO  TO  040-00-10-10-START-FIM.                        
      *                                                                 
             IF  EIBRESP NOT  EQUAL DFHRESP (NORMAL)                    
             AND EIBRESP NOT  EQUAL DFHRESP (DUPKEY)                    
              MOVE  33            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: STARTBR/READNEXT (READPREV).'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
CA2203********  LE O ANTERIOR  (-1)                                     
CA2203     IF  WCH-INVERTE  EQUAL  1                                    
CA2203         MOVE    ZEROES    TO    WCH-INVERTE                      
CA2203         GO    TO    040-00-10-10-START-FIM.                      
      *                                                                 
       040-00-10-10-1-P.                                                
      *                                                                 
070808         EXEC  CICS READPREV FILE('ADPP061')                      
                             LENGTH(WS-LEN-A061)                        
                               INTO(ADP061-REG)                         
                             RIDFLD(ADP061-CHAVE-SEC)                   
                           NOHANDLE                                     
               END-EXEC                                                 
      *                                                                 
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
      *                                                                 
             IF  EIBRESP      EQUAL DFHRESP (NOTFND)                    
                 GO  TO  040-00-10-10-START-FIM.                        
      *                                                                 
             IF  EIBRESP NOT  EQUAL DFHRESP (NORMAL)                    
             AND EIBRESP NOT  EQUAL DFHRESP (DUPKEY)                    
              MOVE  34            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: STARTBR/READPREV            '                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
       040-00-10-10-START-FIM.        EXIT.                             
      ******************************************************************
      /                                                                 
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-30-END-STRT               SECTION.                     
      ******************************************************************
      *                                                                 
050304     IF  WS-E-CRITERIO  EQUAL  13  OR  15  OR  16  OR  17         
              EXEC  CICS  ENDBR FILE('ADPP061')  NOHANDLE               
              END-EXEC                                                  
           ELSE                                                         
              EXEC  CICS  ENDBR FILE('ADPP062') NOHANDLE                
              END-EXEC.                                                 
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF    EIBRESP       NOT EQUAL   ZEROS                        
              MOVE  35            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: ENDSTART                    '                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
       040-00-10-30-END-STRT-FIM.   EXIT.                               
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-10-70-10-MOVE-OCOR             SECTION.                   
      ***************************************************************** 
      *  FINALIDADE :                                                   
      *  - FORMATA AS OCORRENCIAS DA ARRAY QUE RETORNARA AO CHAMADOR    
      ***************************************************************** 
      *                                                                 
           MOVE ADP061-CD-PROPOSTA-ADP TO                               
                VCRC080-S-CD-PROPOSTA-ADP-OC   (WS-IND-S).              
311005     PERFORM 050-00-ST-PROP-CENTRAL.                              
           MOVE ADP061-CD-STATUS       TO                               
                VCRC080-S-CD-STATUS-OC         (WS-IND-S).              
           MOVE ADP061-NO-CPF-CGC      TO                               
                VCRC080-S-NO-CPF-CGC-OC        (WS-IND-S).              
           MOVE ADP061-DT-INCLUSAO     TO                               
                VCRC080-S-DT-INCLUSAO-OC       (WS-IND-S).              
           MOVE ADP061-DT-ULT-ATU      TO                               
                VCRC080-S-DT-ULT-ATU-OC        (WS-IND-S).              
270904     MOVE WS-A051-DATA-CHEC        TO                             
270904          VCRC080-S-DT-CONF-CR-OC        (WS-IND-S).              
           MOVE ADP061-VL-FINANCIADO   TO                               
                VCRC080-S-VL-FINANCIADO-OC     (WS-IND-S).              
050304     MOVE ADP061-CD-LOJA         TO                               
050304          VCRC080-S-CD-INTERMED-OC       (WS-IND-S).              
050304     MOVE ADP061-FPGTO           TO                               
050304          VCRC080-S-FPGTO-OC             (WS-IND-S).              
070808     MOVE ZEROS                  TO                               
050304          VCRC080-S-ID-IMPRES-DOCTO-OC   (WS-IND-S).              
           MOVE ADP004-NO-APROVACAO    TO                               
                VCRC080-S-NO-APROVACAO-OC      (WS-IND-S).              
           MOVE ADP062-NM-COMPLETO     TO                               
                VCRC080-S-NM-COMPLETO-OC       (WS-IND-S).              
      ********************************************                      
      *                                                                 
       040-00-10-70-10-FIM.    EXIT.                                    
      ******************************************************************
      /                                                                 
      ******************************************************************
CA2103 040-00-10-70-20-MOVE-OCOR             SECTION.                   
      ***************************************************************** 
      *  FINALIDADE :                                                   
      *  - FORMATA AS OCORRENCIAS DA ARRAY (ANTERIOR)                   
      ***************************************************************** 
      *                                                                 
           MOVE ADP061-CD-PROPOSTA-ADP TO                               
                VCRC080-S-CD-PROPOSTA-ADP-OC   (WS-IND-F).              
311005     PERFORM 050-00-ST-PROP-CENTRAL.                              
           MOVE ADP061-CD-STATUS       TO                               
                VCRC080-S-CD-STATUS-OC         (WS-IND-F).              
           MOVE ADP061-NO-CPF-CGC      TO                               
                VCRC080-S-NO-CPF-CGC-OC        (WS-IND-F).              
           MOVE ADP061-DT-INCLUSAO     TO                               
                VCRC080-S-DT-INCLUSAO-OC       (WS-IND-F).              
           MOVE ADP061-DT-ULT-ATU      TO                               
                VCRC080-S-DT-ULT-ATU-OC        (WS-IND-F).              
270904     MOVE WS-A051-DATA-CHEC        TO                             
270904          VCRC080-S-DT-CONF-CR-OC        (WS-IND-F).              
           MOVE ADP061-VL-FINANCIADO   TO                               
                VCRC080-S-VL-FINANCIADO-OC     (WS-IND-F).              
050304     MOVE ADP061-CD-LOJA         TO                               
050304          VCRC080-S-CD-INTERMED-OC       (WS-IND-F).              
050304     MOVE ADP061-FPGTO           TO                               
050304          VCRC080-S-FPGTO-OC             (WS-IND-F).              
070808     MOVE ZEROS                  TO                               
050304          VCRC080-S-ID-IMPRES-DOCTO-OC   (WS-IND-F).              
           MOVE ADP004-NO-APROVACAO    TO                               
                VCRC080-S-NO-APROVACAO-OC      (WS-IND-F).              
           MOVE ADP062-NM-COMPLETO     TO                               
                VCRC080-S-NM-COMPLETO-OC       (WS-IND-F).              
           SUBTRACT   1   FROM   WS-IND-F.                              
      ********************************************                      
      *                                                                 
       040-00-10-70-20-FIM.    EXIT.                                    
      ******************************************************************
      /                                                                 
      ******************************************************************
CA2503 040-00-10-70-30-INVERTE               SECTION.                   
CA2203***************************************************************** 
CA2203*  FINALIDADE :                                                   
CA2203*  - FORMATA AS OCORRENCIAS RETIRANDO AS POSSIVEIS EM BRANCO      
CA2203***************************************************************** 
CA2203*                                                                 
CA2503     MOVE  WTB-FIL-PROPOSTA    TO    WTB-PROPOSTA.                
CA2203*                                                                 
CA2203     MOVE  0   TO  WS-IND-I1.                                     
CA2203     MOVE  0   TO  WS-IND-I2.                                     
CA2203*                                                                 
CA2203 040-00-10-70-30-1.                                               
CA2203     ADD  +1   TO  WS-IND-I1.                                     
270904     IF   WS-IND-I1  GREATER  140                                 
CA2203          GO   TO    040-00-10-70-30-2.                           
CA2203*                                                                 
CA2203     IF   VCRC080-S-CD-PROPOSTA-ADP-OC   (WS-IND-I1)              
CA2203          NOT NUMERIC                                             
CA2203     OR   VCRC080-S-CD-PROPOSTA-ADP-OC   (WS-IND-I1)              
CA2203          EQUAL  ZEROES                                           
CA2203          GO    TO    040-00-10-70-30-1.                          
CA2203*                                                                 
CA2203     ADD  +1   TO  WS-IND-I2.                                     
CA2203*                                                                 
CA2203     MOVE VCRC080-S-CD-PROPOSTA-ADP-OC   (WS-IND-I1)              
CA2203     TO         WTB-CD-PROPOSTA-ADP      (WS-IND-I2)              
CA2203     MOVE VCRC080-S-CD-STATUS-OC         (WS-IND-I1)              
CA2203     TO         WTB-CD-STATUS            (WS-IND-I2)              
CA2203     MOVE VCRC080-S-NO-CPF-CGC-OC        (WS-IND-I1)              
CA2203     TO         WTB-NO-CPF-CGC           (WS-IND-I2)              
CA2203     MOVE VCRC080-S-DT-INCLUSAO-OC       (WS-IND-I1)              
CA2203     TO         WTB-DT-INCLUSAO          (WS-IND-I2)              
CA2203     MOVE VCRC080-S-DT-ULT-ATU-OC        (WS-IND-I1)              
CA2203     TO         WTB-DT-ULT-ATU           (WS-IND-I2)              
270904     MOVE VCRC080-S-DT-CONF-CR-OC        (WS-IND-I1)              
270904     TO         WTB-DT-CONF-CR           (WS-IND-I2)              
CA2203     MOVE VCRC080-S-VL-FINANCIADO-OC     (WS-IND-I1)              
CA2203     TO         WTB-VL-FINANCIADO        (WS-IND-I2)              
050304     MOVE VCRC080-S-CD-INTERMED-OC       (WS-IND-I1)              
050304     TO         WTB-CD-INTERMED          (WS-IND-I2)              
050304     MOVE VCRC080-S-FPGTO-OC             (WS-IND-I1)              
050304     TO         WTB-FPGTO                (WS-IND-I2)              
050304     MOVE VCRC080-S-ID-IMPRES-DOCTO-OC   (WS-IND-I1)              
050304     TO         WTB-ID-IMPRES-DOCTO      (WS-IND-I2)              
CA2203     MOVE VCRC080-S-NO-APROVACAO-OC      (WS-IND-I1)              
CA2203     TO         WTB-NO-APROVACAO         (WS-IND-I2)              
CA2203     MOVE VCRC080-S-NM-COMPLETO-OC       (WS-IND-I1)              
CA2203     TO         WTB-NM-COMPLETO          (WS-IND-I2)              
CA2203*                                                                 
CA2203     GO    TO    040-00-10-70-30-1.                               
CA2203*                                                                 
CA2203 040-00-10-70-30-2.                                               
CA2203*                                                                 
CA2503     MOVE  WTB-PROPOSTA     TO    VCRC080-S-PROPOSTA.             
CA2203*                                                                 
CA2203********************************************                      
CA2203*                                                                 
CA2203 040-00-10-70-30-FIM.    EXIT.                                    
CA2203******************************************************************
      /                                                                 
      ******************************************************************
CA1203 040-00-20-SEL-CPFN        SECTION.                               
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - SELECIONAR SEQUENCIALMENTE (A PARTIR DE CHV SEC - CPF/CGC ) *
      ******************************************************************
      *                                                                 
           MOVE  +0                    TO WS-IND-S.                     
      *                                                                 
CA1203 040-00-20-1-CPF.                                                 
      *                                                                 
           MOVE  SPACES                  TO    ADP062-CHAVE-SEC.        
           MOVE  VCRC080-E-NO-CPF-CGC    TO    ADP062-NO-CPF-CGC.       
           MOVE    'NAO'      TO    FL-FIM.                             
      *                                                                 
CA1203     IF  VCRC080-E-SENTIDO-CONSULTA  EQUAL  'P'                   
CA1203       IF  WCH-PESQ-PROX  EQUAL  'N'                              
CA1203           MOVE  'S'  TO  WCH-PESQ-PROX                           
CA0504           MOVE  'NEXT'  TO   WCH-BROWSE                          
CA1203       ELSE                                                       
CA1203        IF  WCH-PESQ-ANT   EQUAL  'N'                             
CA1203           MOVE  'S'  TO  WCH-PESQ-ANT                            
CA0504           MOVE  'PREV'  TO   WCH-BROWSE                          
CA1203        END-IF                                                    
CA1203       END-IF                                                     
CA1203     ELSE                                                         
CA1203        IF  WCH-PESQ-ANT   EQUAL  'N'                             
CA1203           MOVE  'S'  TO  WCH-PESQ-ANT                            
CA0504           MOVE  'PREV'  TO   WCH-BROWSE                          
CA1203        ELSE                                                      
CA1203         IF  WCH-PESQ-PROX  EQUAL  'N'                            
CA1203           MOVE  'S'  TO  WCH-PESQ-PROX                           
CA0504           MOVE  'NEXT'  TO   WCH-BROWSE                          
CA1203         END-IF                                                   
CA1203        END-IF                                                    
CA1203     END-IF.                                                      
      *                                                                 
CA1203     PERFORM 040-00-20-10-START-CPFN.                             
CA1203     PERFORM 040-00-20-20-READN-CPFN                              
CA0404             UNTIL FL-FIM            EQUAL 'SIM'.                 
      *                                                                 
           PERFORM 040-00-10-30-END-STRT.                               
      *                                                                 
CA0504     IF  WCH-BROWSE  EQUAL  'PREV'                                
CA0504         PERFORM 040-00-10-70-30-INVERTE.                         
      *                                                                 
CA1203     IF    WS-IND-S    EQUAL  ZEROES                              
CA1203        IF  WCH-PESQ-PROX  EQUAL  'N'                             
CA1203        OR  WCH-PESQ-ANT   EQUAL  'N'                             
CA1203           GO    TO    040-00-20-1-CPF.                           
      *                                                                 
CA1203 040-00-20-SEL-CPFN-FIM.      EXIT.                               
      ******************************************************************
      /                                                                 
      ******************************************************************
CA1203 040-00-20-10-START-CPFN               SECTION.                   
CA1203******************************************************************
CA1203* FINALIDADE: POSICIONA P/ LER PROXIMO OU ANTERIOR, ONDE:        *
CA1203* (VCRC080-E-SENTIDO-CONSULTA)  (WCH-PESQ-PROX)  (WCH-PESQ-ANT)  *
CA1203* 1)      'P'                       'S'              'N'         *
CA1203* 2)      'P'                       'S'              'S'         *
CA1203* 3)      'A'                       'N'              'S'         *
CA1203* 4)      'A'                       'S'              'S'         *
CA1203* LE-SE:                                                         *
CA1203*       PROXIMO=> QDO. CASO  1)  OU  4)                          *
CA1203*      ANTERIOR=> QDO. CASO  2)  OU  3)                          *
CA1203******************************************************************
      *                                                                 
                                                                        
           EXEC  CICS  STARTBR FILE('ADPP062')                          
                             RIDFLD(ADP062-CHAVE-SEC)                   
070808                   KEYLENGTH (LENGTH OF ADP062-CHAVE-SEC)         
                             GTEQ                                       
                           NOHANDLE                                     
           END-EXEC                                                     
                                                                        
      *                                                                 
           MOVE  EIBRESP TO VCRC080-S-COD-RETORNO-ACESSO.               
                                                                        
           IF    EIBRESP EQUAL DFHRESP (NOTFND)                         
                   MOVE  'SIM'  TO  FL-FIM                              
CA1203             GO    TO    040-00-20-10-START-CPFN-FIM.             
                                                                        
           IF    EIBRESP NOT EQUAL   ZEROS                              
              MOVE  36            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: STARTBR   ADPA062 - CHV.SEC.'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
CA0504     IF     WCH-OBTEM-IND  EQUAL  0                               
CA0504         GO   TO    040-00-20-10-START-CPFN-FIM.                  
      *                                                                 
CA0504 040-00-20-10-1-READ.                                             
      *                                                                 
      ***** POSICIONA  PONTEIRO PARA PESQUISA                           
070808         EXEC  CICS READNEXT FILE('ADPP062')                      
070808                       LENGTH(LENGTH OF ADP062-REG)               
                               INTO(ADP062-REG)                         
                             RIDFLD(ADP062-CHAVE-SEC)                   
                           NOHANDLE                                     
               END-EXEC                                                 
      *                                                                 
           MOVE  EIBRESP TO VCRC080-S-COD-RETORNO-ACESSO.               
      *                                                                 
           IF  EIBRESP  EQUAL DFHRESP (ENDFILE)                         
                   MOVE  'SIM'  TO  FL-FIM                              
                   GO    TO    040-00-20-10-START-CPFN-FIM.             
      *                                                                 
           IF    EIBRESP NOT EQUAL   DFHRESP(NORMAL)                    
           AND   EIBRESP NOT EQUAL   DFHRESP(DUPKEY)                    
              MOVE  37            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO: STARTBR/READNEXT            '                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF  ADP062-CD-PROPOSTA-ADP  NOT EQUAL                        
                                       VCRC080-E-CD-PROPOSTA-ADP        
CA0504         GO   TO   040-00-20-10-1-READ.                           
      *                                                                 
                                                                        
CA1203 040-00-20-10-START-CPFN-FIM.        EXIT.                        
      ******************************************************************
      /                                                                 
      ******************************************************************
CA1203 040-00-20-20-READN-CPFN               SECTION.                   
      ******************************************************************
      *  FINALIDADE :                                                  *
      *  - LER ARQ.PROP X PESSOA PELO CPF AFIM DE OBTER A PROPOSTA     *
      ******************************************************************
      *                                                                 
       040-00-20-20-LER.                                                
      *                                                                 
CA1203     IF     WCH-BROWSE   EQUAL   'NEXT'                           
070808         EXEC  CICS READNEXT FILE('ADPP062')                      
070808                       LENGTH(LENGTH OF ADP062-REG)               
                               INTO(ADP062-REG)                         
                             RIDFLD(ADP062-CHAVE-SEC)                   
                           NOHANDLE                                     
               END-EXEC                                                 
           ELSE                                                         
070808         EXEC  CICS READPREV FILE('ADPP062')                      
070808                       LENGTH(LENGTH OF ADP062-REG)               
                               INTO(ADP062-REG)                         
                             RIDFLD(ADP062-CHAVE-SEC)                   
                           NOHANDLE                                     
               END-EXEC                                                 
           END-IF.                                                      
      *                                                                 
           MOVE  EIBRESP  TO  VCRC080-S-COD-RETORNO-ACESSO.             
      *                                                                 
           IF    EIBRESP  NOT EQUAL   ZEROS                             
             IF  EIBRESP  EQUAL DFHRESP (ENDFILE)                       
                   MOVE  'SIM'  TO  FL-FIM                              
CA1203             GO  TO  040-00-20-20-READN-CPFN-FIM                  
             ELSE                                                       
                IF EIBRESP NOT EQUAL DFHRESP (DUPKEY)                   
              MOVE  39            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO:READ NEXT  ADPA062 - CHV.SEC.'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF   ADP062-NO-CPF-CGC  NOT EQUAL  VCRC080-E-NO-CPF-CGC      
                 MOVE  'SIM'  TO  FL-FIM                                
CA1203           GO    TO    040-00-20-20-READN-CPFN-FIM.               
      *                                                                 
           MOVE  ADP062-CD-PROPOSTA-ADP  TO  ADP061-CD-PROPOSTA-ADP.    
           PERFORM  040-00-30-00-LER-PROP.                              
      *                                                                 
050304     IF  VCRC080-E-CD-INTERMEDIARIO NOT EQUAL 999999              
CA2603        IF  ADP061-CD-LOJA    NOT EQUAL                           
                               VCRC080-E-CD-INTERMEDIARIO               
CA2203********* DESPREZA E LE O SEGUINTE                                
CA0304         GO    TO    040-00-20-20-LER.                            
      *                                                                 
           MOVE  0   TO   WS-IND.                                       
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
      **********  CASO CRITERIO (11=>CPF/12=>CPF+PERIODO)               
      **********                INDEPENDENTEMENTE DO STATUS DA PROPOSTA 
050304     IF  WS-E-CRITERIO  EQUAL  11  OR  12                         
                   GO    TO  040-00-20-20-2-AGENC.                      
      *                                                                 
       040-00-20-20-1-STA.                                              
      *                                                                 
           ADD   1   TO   WS-IND.                                       
           IF  WS-IND  NOT GREATER  20                                  
           AND WS-IND      GREATER  ZERO                                
             IF  VCRC080-E-CD-STATUS (WS-IND)                           
                                     EQUAL  ADP061-CD-STATUS            
                 MOVE  1   TO   WCH-ACHOU                               
             ELSE                                                       
                 GO    TO  040-00-20-20-1-STA.                          
      *                                                                 
      ****************   VERIFICA SE ACHOU O STATUS DENTRE OS PEDIDOS   
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               GO    TO    040-00-20-20-LER.                            
      *                                                                 
           MOVE  0   TO   WS-IND.                                       
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       040-00-20-20-2-AGENC.                                            
             ADD   1   TO   WS-IND.                                     
             IF  WS-IND     NOT GREATER  50                             
             AND WS-IND         GREATER  ZERO                           
               IF  ADP061-AGENC  EQUAL  VCRC080-E-AGENC(WS-IND)         
                   MOVE  1   TO   WCH-ACHOU                             
               ELSE                                                     
                   GO    TO  040-00-20-20-2-AGENC.                      
      *                                                                 
      **************   VERIFICA SE A PROPOSTA PERTENCE AS               
      **************            AGENC+SUBSEG+INTERMEDIARIO PEDIDOS      
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               GO    TO    040-00-20-20-LER.                            
      *                                                                 
           MOVE  0   TO   WS-IND.                                       
           MOVE  0   TO   WCH-ACHOU.                                    
      *                                                                 
       040-00-20-20-3-SUBSEG.                                           
             ADD   1   TO   WS-IND.                                     
             IF  WS-IND     NOT GREATER  50                             
             AND WS-IND         GREATER  ZERO                           
               IF  ADP061-SUBSEG EQUAL  VCRC080-E-SUBSEG (WS-IND)       
                   MOVE  1   TO   WCH-ACHOU                             
               ELSE                                                     
                   GO    TO  040-00-20-20-3-SUBSEG.                     
      *                                                                 
      **************   VERIFICA SE A PROPOSTA PERTENCE AS               
      **************            AGENC+SUBSEG+INTERMEDIARIO PEDIDOS      
           IF  WCH-ACHOU  EQUAL  ZERO                                   
               GO    TO    040-00-20-20-LER.                            
      *                                                                 
      *******         PESQUISA: PERIODO + CPF <=> CRITERIO = 12         
050304     IF  WS-E-CRITERIO  EQUAL  12  OR  13                         
               IF  ADP061-DT-INCLUSAO  LESS  VCRC080-E-DT-INCL-INI      
               OR  ADP061-DT-INCLUSAO  GREATER  VCRC080-E-DT-INCL-FIM   
CA1203             GO    TO    040-00-20-20-LER.                        
      *                                                                 
070808*----------------------------------------------------------------*
070808*---->    CAMPO INDICATIVO DE IMPRESSAO TIRADO NA EXPANSAO  <----*
070808*----------------------------------------------------------------*
070808************************************** SUPORG / FORMALIZACAO      
070808*      IF  VCRC080-E-CRITERIO  EQUAL  21  OR  23                  
070808*        IF  VCRC080-E-DOC-IMPRESSO  EQUAL  'S'                   
070808*          IF  ADP061-ID-IMPRES-DOCTO  EQUAL  00                  
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-20-20-LER                      
070808*          END-IF                                                 
070808*        ELSE                                                     
070808*          IF  ADP061-ID-IMPRES-DOCTO  NOT EQUAL  00              
070808**************   DESPREZA E LE O SEGUINTE                         
070808*               GO    TO    040-00-20-20-LER                      
070808*          END-IF                                                 
070808*        END-IF                                                   
070808*      END-IF.                                                    
070808*                                                                 
CA0504     ADD    1    TO    WS-IND-S.                                  
CA0504     IF  WS-IND-S  GREATER  WS-OCOR-MAX                           
CA0504           MOVE  'SIM'  TO  FL-FIM                                
CA0504           GO    TO    040-00-20-20-READN-CPFN-FIM.               
      *                                                                 
           MOVE  ADP061-CHAVE            TO  ADP004-CHAVE-SEC.          
           PERFORM  040-00-30-30-LER-APROV.                             
      *                                                                 
290704     PERFORM  040-00-20-20-10-1-DATA-CHEC.                        
      *                                                                 
CA0504     IF  WCH-BROWSE  EQUAL 'NEXT'                                 
CA0504         PERFORM 040-00-10-70-10-MOVE-OCOR                        
           ELSE                                                         
CA0504         PERFORM 040-00-10-70-20-MOVE-OCOR                        
           END-IF.                                                      
      *                                                                 
CA1203 040-00-20-20-READN-CPFN-FIM.        EXIT.                        
      ******************************************************************
      /                                                                 
270904*                                                                *
270904******************************************************************
270904 040-00-20-20-10-1-DATA-CHEC    SECTION.                          
270904*----------------------------------------------------------------*
270904*    *  *    START ARQUIVO ADPB051 ( CHECAGENS )   *  *          *
281004*    AFIM DE SELECIONAR O ULTIMO REGISTRO ( DT + HR )            *
270904*----------------------------------------------------------------*
270904                                                                  
270904     MOVE  ZEROES                  TO    WS-A051-DATA-CHEC.       
121104     INITIALIZE                    W-ADPB051-REG.                 
270904                                                                  
270904     MOVE  LOW-VALUES              TO    ADPB051-REG.             
270904                                                                  
270904     MOVE  ADP061-CD-PROPOSTA-ADP  TO    ADPB051-CD-PROPOSTA-ADP. 
270904                                                                  
270904     EXEC  CICS  STARTBR   FILE   ('ADPA051')                     
270904                 RIDFLD    (ADPB051-CHAVE)                        
270904                 KEYLENGTH (LENGTH OF ADPB051-CHAVE)              
270904                 GTEQ                                             
270904                 NOHANDLE                                         
270904     END-EXEC.                                                    
270904                                                                  
270904     IF    EIBRESP  NOT EQUAL DFHRESP(NORMAL)                     
270904     AND   EIBRESP  NOT EQUAL DFHRESP(NOTFND)                     
270904           MOVE  48             TO       VCRC080-S-CD-RETORNO     
270904           MOVE 'ERRO NO START DO ADPA051'                        
270904                                TO       VCRC080-S-DS-RETORNO     
270904           GO  TO   080-00-FINALIZA.                              
270904                                                                  
270904     IF    EIBRESP  EQUAL DFHRESP(NOTFND)                         
270904           GO  TO   040-00-20-20-10-9-EXIT.                       
270904                                                                  
270904 040-00-20-20-10-2-READ-051.                                      
270904                                                                  
270904     EXEC  CICS  READNEXT  FILE   ('ADPA051')                     
270904                 INTO      (ADPB051-REG)                          
270904                 LENGTH    (LENGTH OF ADPB051-REG)                
270904                 RIDFLD    (ADPB051-CHAVE)                        
270904                 KEYLENGTH (LENGTH OF ADPB051-CHAVE)              
270904                 NOHANDLE                                         
270904     END-EXEC.                                                    
270904                                                                  
270904     IF    EIBRESP  NOT EQUAL DFHRESP(NORMAL)                     
270904     AND   EIBRESP  NOT EQUAL DFHRESP(ENDFILE)                    
270904           MOVE  49             TO       VCRC080-S-CD-RETORNO     
270904           MOVE 'ERRO READNEXT ADPA051  '                         
270904                                TO       VCRC080-S-DS-RETORNO     
270904           GO  TO   080-00-FINALIZA.                              
270904                                                                  
270904     IF    EIBRESP  EQUAL DFHRESP(ENDFILE)                        
270904           GO  TO   040-00-20-20-10-3-END-051.                    
270904                                                                  
281004     IF    ADPB051-CD-PROPOSTA-ADP   EQUAL                        
281004                                     ADP061-CD-PROPOSTA-ADP       
281004       IF    ADPB051-TIPO  NOT EQUAL  'CR '                       
270904           GO     TO    040-00-20-20-10-2-READ-051                
281004       END-IF                                                     
281004       IF    ADPB051-DATA-CHEC  LESS W-ADPB051-DATA-CHEC          
270904           GO     TO    040-00-20-20-10-2-READ-051                
281004       END-IF                                                     
281004       IF    ADPB051-DATA-CHEC  EQUAL W-ADPB051-DATA-CHEC         
281004       AND   ADPB051-HORA-CHEC  LESS  W-ADPB051-HORA-CHEC         
270904           GO     TO    040-00-20-20-10-2-READ-051                
281004       END-IF                                                     
281004       MOVE  ADPB051-REG    TO       W-ADPB051-REG                
270904       GO     TO    040-00-20-20-10-2-READ-051                    
270904     END-IF.                                                      
270904                                                                  
270904 040-00-20-20-10-3-END-051.                                       
270904                                                                  
281004     IF  W-ADPB051-STATUS   EQUAL    'C'                          
281004           MOVE  W-ADPB051-DATA-CHEC   TO  WS-A051-DATA-CHEC      
281004     END-IF.                                                      
270904                                                                  
270904     EXEC  CICS   ENDBR    FILE   ('ADPA051')                     
270904     END-EXEC.                                                    
270904                                                                  
270904 040-00-20-20-10-9-EXIT.                                          
270904     EXIT.                                                        
270904*                                                                *
      /                                                                 
      ******************************************************************
       040-00-30-LER-ESPECIFICA    SECTION.                             
      *                                                                 
      ******************************************************************
      * FINALIDADE : LER TODOS ARQS. RELACIONADOS A UMA PROPOSTA       *
      ******************************************************************
      *                                                                 
230903     PERFORM 030-00-05-DATAS.                                     
      *                                                                 
           PERFORM  040-00-30-00-LER-PROPOSTA.                          
      *                                                                 
           PERFORM  040-00-30-10-LER-DADOS-PES.                         
      *                                                                 
           PERFORM  040-00-30-20-LER-GARANTIAS.                         
      *                                                                 
           PERFORM  040-00-30-30-LER-APROVACAO.                         
      *                                                                 
       040-00-30-99-FIM.     EXIT.                                      
      /                                                                 
      ******************************************************************
       040-00-30-00-LER-PROPOSTA   SECTION.                             
      *                                                                 
      ******************************************************************
      * - LER ARQUIVO  ADPA061 (ARQ.BASE DE PROPOSTAS)   P/CHAVE PRIM. *
      ******************************************************************
      *                                                                 
      *                                                                 
           MOVE  SPACES                        TO    ADP061-REG.        
           MOVE  VCRC080-E-CD-PROPOSTA-ADP     TO                       
                                         ADP061-CD-PROPOSTA-ADP.        
      *                                                                 
       040-00-30-00-LER-PROP.                                           
      *                                                                 
                                                                        
           EXEC  CICS  READ   FILE      (WS-A061)                       
                              INTO      (ADP061-REG)                    
                              LENGTH    (WS-LEN-A061)                   
                              KEYLENGTH (WS-KEY-LEN-A061)               
                              RIDFLD    (ADP061-CHAVE)                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF EIBRESP NOT EQUAL ZEROS AND                               
              EIBRESP NOT EQUAL DFHRESP(NOTFND)                         
              MOVE  40            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO:READ ADPA061(CHAVE PRIMARIA).'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF EIBRESP   EQUAL DFHRESP(NOTFND)                           
              MOVE  41            TO  VCRC080-S-CD-RETORNO              
              MOVE  'PROPOSTA NAO ENCONTRADA           '                
                                  TO  VCRC080-S-DS-RETORNO              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
CA2106*******************************    ESPECIFICA                     
050304     IF  WS-E-CRITERIO  EQUAL 02                                  
121203       IF  VCRC080-E-NO-CPF-CGC     NUMERIC                       
121203       AND VCRC080-E-NO-CPF-CGC GREATER ZEROES                    
240703       AND ADP061-NO-CPF-CGC   NOT  EQUAL  VCRC080-E-NO-CPF-CGC   
240703         MOVE  41            TO  VCRC080-S-CD-RETORNO             
240703         MOVE  'PROPOSTA NAO ENCONTRADA(A)        '               
240703                            TO  VCRC080-S-DS-RETORNO              
240703           GO  TO  080-00-FINALIZA                                
240703       END-IF                                                     
090903       IF    VCRC080-E-AGENC(1) NUMERIC                           
090903        AND  VCRC080-E-AGENC(1) GREATER  ZEROES                   
090903         MOVE  1  TO  WS-IND-FIL                                  
090903         PERFORM 030-00-07-2-FIL  THRU  030-00-07-3-FIL           
090903         IF  ADP061-AGENC  NOT EQUAL VCRC080-E-AGENC(1)           
090903           MOVE  41            TO  VCRC080-S-CD-RETORNO           
090903           MOVE  'PROPOSTA NAO ENCONTRADA(B)        '             
090903                            TO  VCRC080-S-DS-RETORNO              
090903           GO  TO  080-00-FINALIZA                                
090903         END-IF                                                   
090903       END-IF                                                     
CA2106       GO  TO  040-00-30-00-99                                    
240703     END-IF.                                                      
      *                                                                 
           IF      ADP061-AGENC  NOT EQUAL VCRC080-E-AGENC(1)           
           OR      ADP061-CD-LOJA NOT EQUAL VCRC080-E-CD-INTERMEDIARIO  
              MOVE  41            TO  VCRC080-S-CD-RETORNO              
              MOVE  'PROPOSTA NAO ENCONTRADA(C)        '                
                                  TO  VCRC080-S-DS-RETORNO              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           PERFORM  040-00-30-00-10-VERIF-SEG.                          
      *                                                                 
CA2106**   IF  VCRC080-E-NO-CPF-CGC NOT EQUAL SPACES AND LOW-VALUES     
CA2106**   AND ADP061-NO-CPF-CGC   NOT  EQUAL  VCRC080-E-NO-CPF-CGC     
CA2106**      MOVE  41            TO  VCRC080-S-CD-RETORNO              
CA2106**      MOVE  'PROPOSTA NAO ENCONTRADA           '                
CA2106**                          TO  VCRC080-S-DS-RETORNO              
CA2106**         GO  TO  080-00-FINALIZA.                               
      *                                                                 
      *                                                                 
       040-00-30-00-99.                                                 
      *                                                                 
           MOVE    1     TO    WS-IND-S.                                
      *                                                                 
           MOVE ADP061-AGENC            TO VCRC080-S-AGENC              
           MOVE ADP061-SUBSEG           TO VCRC080-S-SUBSEG             
           MOVE ADP061-CD-LOJA          TO VCRC080-S-CD-LOJA            
           MOVE ADP061-CD-VENDEDOR      TO VCRC080-S-CD-VENDEDOR        
           IF ADP061-CD-VENDEDOR NOT EQUAL 0                            
CD6939        PERFORM 049-00-NM-VENDEDOR                                
           END-IF                                                       
CD6939*****MOVE ADP061-NOME-VENDEDOR    TO VCRC080-S-NOME-VENDEDOR      
           MOVE ADP061-DDD-LOJA         TO VCRC080-S-DDD-LOJA           
           MOVE ADP061-FONE-LOJA        TO VCRC080-S-FONE-LOJA          
070808     MOVE ZEROS                   TO VCRC080-S-CD-FIL-LOJA        
311005     PERFORM 050-00-ST-PROP-CENTRAL.                              
           MOVE ADP061-CD-STATUS        TO VCRC080-S-CD-STATUS          
           MOVE ADP061-DT-INCLUSAO      TO VCRC080-S-DT-INCLUSAO        
           MOVE ADP061-DT-APROVACAO     TO VCRC080-S-DT-APROVACAO       
           MOVE ADP061-CD-PROPOSTA-ADP  TO VCRC080-S-CD-PROPOSTA-ADP    
           MOVE ADP061-CD-CONTROLE-LOJA TO VCRC080-S-CD-CONTROLE-LOJA   
           MOVE ADP061-CD-PROPOSTA-LFV  TO VCRC080-S-CD-PROPOSTA-LFV    
           MOVE ADP061-PRODT-ID         TO VCRC080-S-PRODT-ID           
           MOVE ADP061-CD-CTX           TO VCRC080-S-CD-CTX             
           MOVE ADP061-TP-MOEDA         TO VCRC080-S-TP-MOEDA           
           MOVE ADP061-VL-TX-ANO        TO VCRC080-S-VL-TX-ANO          
           MOVE ADP061-VL-TX-ANO-ABN    TO VCRC080-S-VL-TX-ANO-ABN      
           MOVE ADP061-VL-TX-MES        TO VCRC080-S-VL-TX-MES          
           MOVE ADP061-VL-IOF           TO VCRC080-S-VL-IOF             
           MOVE ADP061-VL-TAC           TO VCRC080-S-VL-TAC             
           MOVE ADP061-VL-TEC           TO VCRC080-S-VL-TEC             
           MOVE ADP061-DT-PRIM-VCTO     TO VCRC080-S-DT-PRIM-VCTO       
           MOVE ADP061-DT-TERMINO       TO VCRC080-S-DT-TERMINO         
           MOVE ADP061-QT-PRESTACAO     TO VCRC080-S-QT-PRESTACAO       
           MOVE ADP061-VL-FINANCIADO    TO VCRC080-S-VL-FINANCIADO      
           MOVE ADP061-VL-LIQUIDO       TO VCRC080-S-VL-LIQUIDO         
           MOVE ADP061-VL-ENTRADA       TO VCRC080-S-VL-ENTRADA         
           MOVE ADP061-VL-PRESTACAO     TO VCRC080-S-VL-PRESTACAO       
           MOVE ADP061-VL-SEGURO        TO VCRC080-S-VL-SEGURO          
           MOVE ADP061-FPGTO            TO VCRC080-S-FPGTO              
200804     IF   ADP061-VL-SUBSIDIO-MONT EQUAL    ZEROES                 
200804     AND  ADP061-VL-SUBSIDIO-CONC EQUAL    ZEROES                 
200804         MOVE 'N'                 TO VCRC080-S-IC-SBD             
200804     ELSE                                                         
200804         MOVE 'S'                 TO VCRC080-S-IC-SBD.            
           MOVE ADP061-INDICE-CORRECAO  TO VCRC080-S-INDICE-CORRECAO    
           MOVE ADP061-COD-COMISSAO     TO VCRC080-S-COD-COMISSAO       
           MOVE ADP061-PROJ-ESCOLA      TO VCRC080-S-PROJ-ESCOLA        
CA2905*****                        AFC                                  
CA2905     IF   ADP061-IC-CANAL-CAP  EQUAL  01                          
CA2905         MOVE ADP061-CD-OBJ-FIN   TO VCRC080-S-CD-OBJ-FIN.        
CA2905*                                                                 
           MOVE ADP061-DS-OBS-LOJISTA   TO VCRC080-S-DS-OBS-LOJISTA.    
100603     MOVE ADP061-TP-LOGISTICA     TO VCRC080-S-TIPO-LOGISTICA.    
100603     MOVE ADP061-END-LOGISTICA    TO VCRC080-S-ENDER-LOGISTICA.   
      *                                                                 
       040-00-30-00-99-FIM.     EXIT.                                   
      ******************************************************************
      *                                                                 
      /                                                                 
CA1004******************************************************************
CA1004* VERIFICA SE A PROPOSTA PERTENCE AO SEGMENTO DO LOJISTA          
CA1004* (FUTURAMENTE SE VERIFICARAH TAMBEM A FILIAL)                    
CA1004*                                                                 
CA1004 040-00-30-00-10-VERIF-SEG     SECTION.                           
CA1004*                                                                 
CA1004     MOVE  0   TO   WS-IND.                                       
CA1004     MOVE  0   TO   WCH-ACHOU.                                    
CA1004*                                                                 
CA1004 040-00-30-00-10-2.                                               
CA1004*                                                                 
CA1004     ADD   1   TO   WS-IND.                                       
CA1004     IF  WS-IND       NOT GREATER  50                             
CA1004       IF  VCRC080-E-SUBSEG (WS-IND) NOT NUMERIC                  
CA1004       OR  VCRC080-E-SUBSEG (WS-IND) EQUAL ZEROS                  
CA1004           SUBTRACT    1   FROM   WS-IND                          
CA1004       ELSE                                                       
CA1004       IF  VCRC080-E-SUBSEG (WS-IND) EQUAL ADP061-SUBSEG          
CA1004           MOVE  1   TO   WCH-ACHOU                               
CA1004       ELSE                                                       
CA1004           GO    TO  040-00-30-00-10-2.                           
CA1004*                                                                 
CA1004     IF  WCH-ACHOU  EQUAL  ZERO                                   
CA1004        MOVE  41            TO  VCRC080-S-CD-RETORNO              
CA1004        MOVE  'PROPOSTA NAO ENCONTRADA           '                
CA1004                            TO  VCRC080-S-DS-RETORNO              
CA1004         GO  TO  080-00-FINALIZA.                                 
CA1004*                                                                 
CA1004 040-00-30-00-10-FIM.     EXIT.                                   
      ******************************************************************
      *                                                                 
      /                                                                 
      ******************************************************************
       040-00-30-10-LER-DADOS-PES    SECTION.                           
      *                                                                 
      ******************************************************************
      * FINALIDADE :                                                   *
      * - LER ARQUIVO  ADPA062 (ARQ.DADOS PESSOAIS)      P/CHAVE PRIM. *
      ******************************************************************
      *                                                                 
           MOVE  SPACES                        TO    ADP062-REG.        
           MOVE  VCRC080-E-CD-PROPOSTA-ADP     TO                       
                                         ADP062-CD-PROPOSTA-ADP.        
           MOVE  ZEROES                        TO    ADP062-CD-PESSOA.  
      *                                                                 
       040-00-30-10-1-PESSOAIS.                                         
      *                                                                 
           ADD   1     TO     ADP062-CD-PESSOA.                         
           IF    ADP062-CD-PESSOA  EQUAL    04                          
                 GO    TO    040-00-30-10-1-PESSOAIS.                   
           IF    ADP062-CD-PESSOA  GREATER  05                          
                 GO    TO    040-00-30-10-LER-DADOS-PES-FIM.            
      *                                                                 
       040-00-30-10-2-LER-PESSOAIS.                                     
      *                                                                 
070808     EXEC  CICS  READ   FILE      ('ADPA062')                     
                              INTO      (ADP062-REG)                    
                              LENGTH    (LENGTH OF ADP062-REG)          
070808                        KEYLENGTH (LENGTH OF ADP062-CHAVE)        
                              RIDFLD    (ADP062-CHAVE)                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF EIBRESP NOT EQUAL ZEROS AND                               
              EIBRESP NOT EQUAL DFHRESP(NOTFND)                         
              MOVE  42            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO:READ ADPA062(CHAVE PRIMARIA).'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF EIBRESP   EQUAL DFHRESP(NOTFND)                           
              IF    ADP062-CD-PESSOA  EQUAL   01                        
                 MOVE  43            TO  VCRC080-S-CD-RETORNO           
                 MOVE  'DADOS DO TITULAR NAO ENCONTRADO.'               
                                  TO  VCRC080-S-DS-RETORNO              
                 GO  TO  080-00-FINALIZA                                
              ELSE                                                      
CA2203***********MOVE  'DADOS DO CONJUGE/AVALISTA NAO ENCONTRADO '      
121203           GO    TO    040-00-30-10-1-PESSOAIS.                   
      *                                                                 
       040-00-30-10-3.                                                  
191203*----------------------------------------------------------------*
191203*---->  ARQUIVO ADPA008(CADASTRO DE BENS) NAO SERA UTILI-  <-----*
191203*---->  ZADO NA UNIFICACAO                                 <-----*
191203*----------------------------------------------------------------*
191203     IF ADP062-CD-PESSOA  EQUAL   01                              
191203*          PERFORM     040-00-30-40-LER-BENS                      
191203       MOVE  ' '                     TO VCRC080-S-DS-VEICULO      
191203                                        VCRC080-S-DS-IMOVEL       
191203       MOVE  ZEROS                   TO VCRC080-S-VL-VEICULO      
191203                                        VCRC080-S-VL-IMOVEL       
             MOVE ADP062-NM-COMPLETO       TO VCRC080-S-NM-COMPLETO     
             MOVE ADP062-CD-TIPO-PESSOA    TO VCRC080-S-CD-TIPO-PESSOA  
             MOVE ADP062-CD-PESSOA         TO VCRC080-S-CD-PESSOA       
             MOVE ADP062-NO-CPF-CGC        TO VCRC080-S-NO-CPF-CGC      
             MOVE ADP062-DT-NASC           TO VCRC080-S-DT-NASC         
121203       MOVE ADP062-NO-IDENT          TO VCRC080-S-NO-DOC          
121203       MOVE ADP062-TP-DOC            TO VCRC080-S-TP-DOC          
             MOVE ADP062-NM-ORG-EMISSOR    TO VCRC080-S-NM-ORG-EMISSOR  
             MOVE ADP062-UF-ORG-EMISSOR    TO VCRC080-S-UF-ORG-EMISSOR  
121203       MOVE ADP062-DT-EMISSAO-EMISSOR  TO VCRC080-S-DT-ORG-EMISSOR
121203       MOVE ADP062-CD-PAIS-DOC       TO VCRC080-S-CD-PAIS-DOC     
             MOVE ADP062-CD-SEXO           TO VCRC080-S-CD-SEXO         
             MOVE ADP062-CD-EST-CIVIL      TO VCRC080-S-CD-EST-CIVIL    
             MOVE ADP062-CD-NACIONALIDADE  TO VCRC080-S-CD-NACIONALIDADE
             MOVE ADP062-NATURALIDADE      TO VCRC080-S-NATURALIDADE    
             MOVE ADP062-SG-UF-NATURALIDADE TO                          
                                           VCRC080-S-SG-UF-NATURALIDADE 
             MOVE ADP062-NM-PAI            TO VCRC080-S-NM-PAI          
             MOVE ADP062-NM-MAE            TO VCRC080-S-NM-MAE          
             MOVE ADP062-GRAU-INSTRUCAO    TO VCRC080-S-GRAU-INSTRUCAO  
             MOVE ADP062-E-MAIL-RES        TO VCRC080-S-E-MAIL          
             MOVE ADP062-IC-FUNC-ABN       TO VCRC080-S-IC-FUNC-ABN     
             MOVE ADP062-DS-END-RES        TO VCRC080-S-DS-END-RESID    
             MOVE ADP062-NRO-RES           TO VCRC080-S-NUM-END-RESID   
             MOVE ADP062-COMPL-RES         TO VCRC080-S-COMPL-END-RES   
             MOVE ADP062-NM-BAIRRO-RES     TO VCRC080-S-NM-BAIRRO-RES   
             MOVE ADP062-NM-CIDADE-RES     TO VCRC080-S-NM-CIDADE-RES   
             MOVE ADP062-SG-UF-RES         TO VCRC080-S-SG-UF-RES       
             MOVE ADP062-CD-CEP-RES        TO VCRC080-S-CD-CEP-RES      
             MOVE ADP062-TP-RESID-RES      TO VCRC080-S-CD-TP-RESID     
121203       MOVE ADP062-ANO-RESID-RES     TO VCRC080-S-ANO-RESID       
121203       MOVE ADP062-MES-RESID-RES     TO VCRC080-S-MES-RESID       
             MOVE ADP062-NO-DDD-TELEF-RES  TO VCRC080-S-NO-DDD-TELEF-RES
             MOVE ADP062-NO-TELEF-RES      TO VCRC080-S-NO-TELEF-RES    
             MOVE ADP062-TP-TELEF-RES      TO VCRC080-S-CD-TP-TELEF     
             MOVE ADP062-DDD-TEL-CEL-RES   TO VCRC080-S-NO-DDD-TEL-CEL  
             MOVE ADP062-TEL-CEL-RES       TO VCRC080-S-NO-TEL-CEL      
             MOVE ADP062-CD-END-CORRESP    TO VCRC080-S-CD-END-CORRESP  
             MOVE ADP062-NM-EMPRESA        TO VCRC080-S-NM-EMPRESA      
             MOVE ADP062-CNPJ-EMP          TO VCRC080-S-NO-CGC-EMPRESA  
             MOVE ADP062-NAT-OCUPACAO      TO VCRC080-S-CD-OCUPACAO     
121203       MOVE ADP062-COD-PROFISS       TO VCRC080-S-CD-PROFISSAO    
121203       MOVE ADP062-DS-OCUPACAO       TO VCRC080-S-DS-PROFISSAO    
             MOVE ADP062-DT-ADMISSAO TO VCRC080-S-DT-TEMPO-ADMISSAO     
             MOVE ADP062-VL-RENDA-MENSAL   TO VCRC080-S-VL-RENDA-MENSAL 
             MOVE ADP062-VL-OUTRAS-RENDAS  TO VCRC080-S-VL-OUTRAS-RENDAS
             MOVE ADP062-DS-END-COM        TO VCRC080-S-DS-END-COM      
             MOVE ADP062-NM-BAIRRO-COM     TO VCRC080-S-NM-BAIRRO-COM   
121203       MOVE ADP062-COMPL-COM         TO VCRC080-S-COMP-COM        
121203       MOVE ADP062-NRO-COM           TO VCRC080-S-NRO-COM         
             MOVE ADP062-NM-CIDADE-COM     TO VCRC080-S-NM-CIDADE-COM   
             MOVE ADP062-SG-UF-COM         TO VCRC080-S-SG-UF-COM       
             MOVE ADP062-CD-CEP-COM        TO VCRC080-S-CD-CEP-COM      
             MOVE ADP062-NO-DDD-TELEF-COM  TO VCRC080-S-NO-DDD-TELEF-COM
             MOVE ADP062-NO-TELEF-COM      TO VCRC080-S-NO-TELEF-COM    
             MOVE ADP062-NO-RAMAL-COM      TO VCRC080-S-NO-RAMAL-COM    
             MOVE ADP062-TP-TELEF-COM TO VCRC080-S-CD-TP-TELEF-COM      
             MOVE ADP062-CD-BANCO          TO VCRC080-S-CD-BANCO        
             MOVE ADP062-CD-AGENCIA        TO VCRC080-S-CD-AGENCIA      
121203       MOVE ADP062-DG-AGENCIA        TO VCRC080-S-DG-AGENCIA      
             MOVE ADP062-NO-CONTA-COR      TO VCRC080-S-NO-CONTA-COR    
             MOVE ADP062-DG-CONTA-COR      TO VCRC080-S-DG-CONTA-COR    
             MOVE ADP062-TP-CONTA-COR      TO VCRC080-S-TP-CONTA-COR    
121203       MOVE ADP062-ANOABERTURA       TO VCRC080-S-ANO-CLI-DESDE   
121203       MOVE ADP062-MESABERTURA       TO VCRC080-S-MES-CLI-DESDE   
             MOVE ADP062-NO-DDD-TEL        TO VCRC080-S-NO-DDD-TEL-AGENC
             MOVE ADP062-NO-TEL            TO VCRC080-S-NO-TEL-AGENC    
             MOVE ADP062-NM-REF-1          TO VCRC080-S-NM-REF-1        
             MOVE ADP062-NO-DDD-REF-1      TO VCRC080-S-NO-DDD-REF-1    
             MOVE ADP062-NO-TEL-REF-1      TO VCRC080-S-NO-TEL-REF-1    
             MOVE ADP062-NM-REF-2          TO VCRC080-S-NM-REF-2        
             MOVE ADP062-NO-DDD-REF-2      TO VCRC080-S-NO-DDD-REF-2    
             MOVE ADP062-NO-TEL-REF-2      TO VCRC080-S-NO-TEL-REF-2    
           END-IF.                                                      
      *                                                                 
           IF    ADP062-CD-PESSOA  EQUAL   02                           
           MOVE ADP062-NM-COMPLETO       TO VCRC080-S-NM-COMPLETO-CONJ  
           MOVE ADP062-NO-CPF-CGC        TO VCRC080-S-NO-CPF-CGC-CONJ   
           MOVE ADP062-DT-NASC           TO VCRC080-S-DT-NASC-CONJ      
121203     MOVE ADP062-NO-IDENT          TO VCRC080-S-NO-DOC-CONJ       
           MOVE ADP062-NM-ORG-EMISSOR    TO VCRC080-S-NM-ORG-EMIS-CONJ  
           MOVE ADP062-UF-ORG-EMISSOR    TO VCRC080-S-UF-ORG-EMIS-CONJ  
121203     MOVE ADP062-DT-EMISSAO-EMISSOR TO VCRC080-S-DT-ORG-EMIS-CONJ 
121203     MOVE ADP062-CD-PAIS-DOC       TO VCRC080-S-CD-PAIS-DOC-CONJ  
           MOVE ADP062-NM-EMPRESA        TO VCRC080-S-NM-EMPRESA-CONJ   
           MOVE ADP062-NAT-OCUPACAO      TO VCRC080-S-CD-OCUPACAO-CONJ  
           MOVE ADP062-DS-OCUPACAO       TO VCRC080-S-DS-PROFISSAO-CONJ 
           MOVE ADP062-VL-RENDA-MENSAL   TO VCRC080-S-VL-RENDA-MES-CONJ 
           MOVE ADP062-DT-ADMISSAO       TO VCRC080-S-DT-ADMISSAO-CONJ  
           MOVE ADP062-NO-DDD-TELEF-COM  TO VCRC080-S-NO-DDD-COM-CONJ   
           MOVE ADP062-NO-TELEF-COM      TO VCRC080-S-NO-TEL-COM-CONJ   
           MOVE ADP062-NO-RAMAL-COM      TO VCRC080-S-NO-RAMAL-COM-CONJ 
      *                                                                 
           END-IF.                                                      
      *                                                                 
           IF    ADP062-CD-PESSOA  EQUAL   03                           
           MOVE ADP062-NM-COMPLETO     TO VCRC080-S-NM-COMPLETO-AVAL1   
           MOVE ADP062-NO-CPF-CGC      TO VCRC080-S-NO-CPF-CGC-AV1      
           MOVE ADP062-CD-TP-REPRESENT TO VCRC080-S-CD-TP-REPRES-AV1    
           MOVE ADP062-CD-PESSOA       TO VCRC080-S-CD-PESSOA-AV1       
           END-IF.                                                      
      *                                                                 
           IF    ADP062-CD-PESSOA  EQUAL   05                           
           MOVE ADP062-NM-COMPLETO     TO VCRC080-S-NM-COMPLETO-AVAL2   
           MOVE ADP062-NO-CPF-CGC      TO VCRC080-S-NO-CPF-CGC-AV2      
           MOVE ADP062-CD-TP-REPRESENT TO VCRC080-S-CD-TP-REPRES-AV2    
           MOVE ADP062-CD-PESSOA       TO VCRC080-S-CD-PESSOA-AV2       
           END-IF.                                                      
      *                                                                 
           GO    TO    040-00-30-10-1-PESSOAIS.                         
      *                                                                 
       040-00-30-10-LER-DADOS-PES-FIM.    EXIT.                         
      *                                                                 
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-30-20-LER-GARANTIAS    SECTION.                           
      *                                                                 
      ******************************************************************
      * FINALIDADE :                                                   *
      * - LER ARQUIVO  ADPA063 (ARQ.GARANTIAS)           P/CHAVE PRIM. *
      ******************************************************************
      *                                                                 
121203     IF  ADP061-PRODT-ID  EQUAL  0011                             
121203     AND ( ADP061-SUBSEG  EQUAL  441  OR  461 )                   
121203************   NAO  POSSUEM  GARANTIAS                            
121203           GO    TO    040-00-30-20-LER-GARANTIAS-FIM.            
      *                                                                 
           MOVE  SPACES                        TO    ADP063-REG.        
           MOVE  VCRC080-E-CD-PROPOSTA-ADP     TO                       
                                         ADP063-CD-PROPOSTA-ADP.        
           MOVE  ZEROES                        TO    ADP063-SQ-GARANTIA.
      *                                                                 
       040-00-30-20-1-GARANTIAS.                                        
      *                                                                 
           ADD   1     TO     ADP063-SQ-GARANTIA.                       
           IF    ADP063-SQ-GARANTIA  GREATER  01                        
                 GO    TO    040-00-30-20-LER-GARANTIAS-FIM.            
      *                                                                 
           EXEC  CICS  READ   FILE      (WS-A003)                       
                              INTO      (ADP063-REG)                    
                              LENGTH    (WS-LEN-A003)                   
                              KEYLENGTH (WS-KEY-LEN-A003)               
                              RIDFLD    (ADP063-CHAVE)                  
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF EIBRESP NOT EQUAL ZEROS AND                               
              EIBRESP NOT EQUAL DFHRESP(NOTFND)                         
              MOVE  44            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO:READ ADPA063(CHAVE PRIMARIA).'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
060204     IF EIBRESP   EQUAL DFHRESP(NOTFND)                           
060204         PERFORM 040-00-30-20-10-DS-OBJ-GAR                       
060204         IF STIC584-CD-RET-COD-RE NOT = 0                         
060204             MOVE SPACES             TO  VCRC080-S-DS-MARCA       
060204                                         VCRC080-S-DS-MODELO      
060204                                         VCRC080-S-DS-GARANTIA    
060204             MOVE  45                TO  VCRC080-S-CD-RETORNO     
060204             MOVE STIC584-DS-MSG-RE  TO  VCRC080-S-DS-RETORNO     
060204         ELSE                                                     
060204             MOVE STIC584-DS-OBJ(1)  TO  VCRC080-S-DS-GARANTIA    
060204         END-IF                                                   
060204       GO    TO    040-00-30-20-LER-GARANTIAS-FIM                 
060204     END-IF.                                                      
      *                                                                 
           MOVE ADP063-DS-MARCA          TO VCRC080-S-DS-MARCA          
           MOVE ADP063-DS-MODELO         TO VCRC080-S-DS-MODELO         
           MOVE ADP063-VL-ATUAL          TO VCRC080-S-VL-ATUAL          
           MOVE ADP063-DS-GARANTIA       TO VCRC080-S-DS-GARANTIA       
CA2905*****                      APC                                    
CA2905     IF  ADP061-IC-CANAL-CAP  EQUAL  02                           
CA2905        MOVE ADP063-CD-OBJ-FINANCIADO TO VCRC080-S-CD-OBJ-FIN.    
CA2905*                                                                 
CA0904     MOVE ADP063-ANO-FABRICACAO    TO VCRC080-S-ANO-FABRICACAO.   
CA0904     MOVE ADP063-ANO-MODELO        TO VCRC080-S-ANO-MODELO.       
CA0904     MOVE ADP063-ID-NOVO           TO VCRC080-S-ID-NOVO.          
CA0904     MOVE ADP063-TP-COMBUSTIVEL    TO VCRC080-S-TP-COMBUSTIVEL.   
CA0904     MOVE ADP063-NO-CHASSI-SERIE   TO VCRC080-S-NO-CHASSI-SERIE.  
CA0904     MOVE ADP063-NO-PLACA          TO VCRC080-S-NO-PLACA.         
CA0904     MOVE ADP063-DS-COR            TO VCRC080-S-DS-COR.           
CA0904     MOVE ADP063-IC-ADAPTADO       TO VCRC080-S-IC-ADAPTADO.      
CA0904     MOVE ADP063-IC-TAXI           TO VCRC080-S-IC-TAXI.          
      *                                                                 
           GO    TO    040-00-30-20-1-GARANTIAS.                        
      *                                                                 
       040-00-30-20-LER-GARANTIAS-FIM.    EXIT.                         
      ******************************************************************
      *                                                                 
      ******************************************************************
060204 040-00-30-20-10-DS-OBJ-GAR SECTION.                              
060204*----------------------------------------------------------------*
060204*----->   ACESSA A DESCRICAO DO OBJETO FINANCIADO         <------*
060204*----->           SERVICO STIR584                         <------*
060204*----------------------------------------------------------------*
060204     INITIALIZE STIC584.                                          
060204     MOVE ADP061-CD-OBJ-FIN              TO STIC584-SG-OBJ-EN.    
060204     MOVE 01                             TO STIC584-TP-ACC-EN.    
060204     MOVE  ' '                           TO STIC584-CD-STA-RGS-EN.
060204     MOVE  1                             TO STIC584-CD-TPO-OPC-EN.
060204     MOVE  'VCR'                         TO STIC584-SG-SIS-EN.    
060204     MOVE  ' '                           TO STIC584-DS-OBJ-EN.    
060204                                                                  
060204     EXEC CICS LINK                                               
060204         PROGRAM  ('STIR584')                                     
060204         COMMAREA (STIC584)                                       
060204         LENGTH   (LENGTH OF STIC584)                             
060204         NOHANDLE                                                 
060204     END-EXEC.                                                    
060204                                                                  
060204     IF EIBRESP   NOT EQUAL DFHRESP(NORMAL)                       
060204         MOVE  45                   TO  VCRC080-S-CD-RETORNO      
060204         MOVE 'ERRO LINK STIR284-DS GAR' TO VCRC080-S-DS-RETORNO  
060204         GO  TO  080-00-FINALIZA.                                 
060204                                                                  
060204 040-00-30-20-10-99-EXIT.                                         
060204     EXIT.                                                        
      *----------------------------------------------------------------*
      ******************************************************************
      /                                                                 
      ******************************************************************
       040-00-30-30-LER-APROVACAO    SECTION.                           
      *                                                                 
      ******************************************************************
      * FINALIDADE :                                                   *
      * - LER ARQUIVO  ADPA004 (ARQ.APROVACAO)           P/CHAVE SEC.  *
      ******************************************************************
      *                                                                 
           MOVE  SPACES                        TO    ADP004-REG.        
           MOVE  ADP061-CHAVE                  TO    ADP004-CHAVE-SEC.  
      *                                                                 
       040-00-30-30-LER-APROV.                                          
      *                                                                 
           EXEC  CICS  READ   FILE      (WS-P004)                       
                              INTO      (ADP004-REG)                    
                              LENGTH    (WS-LEN-A004)                   
                              KEYLENGTH (WS-KEY-LEN-P004)               
                              RIDFLD    (ADP004-CHAVE-SEC)              
                              NOHANDLE                                  
           END-EXEC.                                                    
      *                                                                 
           MOVE  EIBRESP               TO  VCRC080-S-COD-RETORNO-ACESSO.
      *                                                                 
           IF EIBRESP NOT EQUAL ZEROS AND                               
              EIBRESP NOT EQUAL DFHRESP(NOTFND)                         
              MOVE  46            TO  VCRC080-S-CD-RETORNO              
              MOVE  'ERRO:READ ADPA004(CHAVE SECUNDARIA'                
                                  TO  VCRC080-S-DS-RETORNO              
                 PERFORM 100-00-LOGA-ABEND                              
                 GO  TO  080-00-FINALIZA.                               
      *                                                                 
           IF EIBRESP   EQUAL DFHRESP(NOTFND)                           
090903        MOVE  ZEROS         TO EIBRESP                            
090903        MOVE  ZEROS         TO VCRC080-S-CD-RETORNO               
15/07         MOVE  ZEROS         TO ADP004-NO-APROVACAO.               
      *                                                                 
      ********MOVE  47            TO  VCRC080-S-CD-RETORNO              
      ********MOVE  'NAO ACHOU NRO.APROVACAO(ADPA004)  '                
      ********                    TO  VCRC080-S-DS-RETORNO.             
      *                                                                 
       040-00-30-30-99.                                                 
      *                                                                 
           MOVE  ADP004-NO-APROVACAO TO VCRC080-S-NO-APROVACAO.         
      *                                                                 
       040-00-30-30-99-FIM.             EXIT.                           
      *                                                                 
      ******************************************************************
      * MOVIMENTA NOME DO VENDEDOR                                     *
      ******************************************************************
CD6939 049-00-NM-VENDEDOR              SECTION.                         
                                                                        
           INITIALIZE CIPC79I.                                          
           MOVE 1                       TO CIPC79I-QT-PRC-EN.           
           MOVE 1                       TO CIPC79I-CD-TPO-OPC-EN.       
           MOVE ADP061-CD-LOJA          TO CIPC79I-CHV-CD-INT.          
           MOVE ADP061-CD-VENDEDOR      TO CIPC79I-CHV-CD-VND.          
           MOVE SPACES                  TO VCRC080-S-NOME-VENDEDOR.     
                                                                        
           EXEC CICS                                                    
               LINK  PROGRAM  ('CIPR79I')                               
                     COMMAREA (CIPC79I)                                 
                     LENGTH   (LENGTH OF CIPC79I)                       
           END-EXEC.                                                    
                                                                        
           IF CIPC79I-CD-RET-COD NOT EQUAL 0                            
              IF CIPC79I-CD-RET-COD NOT EQUAL 1                         
                  GO 049-00-99-EXIT                                     
              ELSE                                                      
                  GO 20-33-LER-TAB640.                                  
                                                                        
           IF CD-IND-ATVA-REG-663(1) EQUAL 0                            
              GO 049-00-99-EXIT.                                        
      *                                                                 
           INITIALIZE CIPC32I.                                          
           MOVE 1                       TO CIPC32I-CD-TPO-OPC-EN.       
           MOVE CIPC79I-CD-VND(1)       TO CIPC32I-CHV-CD-INT.          
           EXEC CICS                                                    
               LINK  PROGRAM  ('CIPR32I')                               
                     COMMAREA (CIPC32I)                                 
                     LENGTH   (LENGTH OF CIPC32I)                       
           END-EXEC.                                                    
      *                                                                 
           IF CIPC32I-CD-RET-COD NOT EQUAL 0                            
              IF CIPC32I-CD-RET-COD NOT EQUAL 1                         
                 GO 049-00-99-EXIT                                      
              ELSE                                                      
                 GO 049-00-99-EXIT                                      
           ELSE                                                         
               MOVE NM-INTERM-516       TO VCRC080-S-NOME-VENDEDOR      
               GO 049-00-99-EXIT.                                       
                                                                        
      *                                                                 
       20-33-LER-TAB640.                                                
      *                                                                 
           INITIALIZE CIPC32R.                                          
           MOVE 1                       TO CIPC32R-CD-TPO-OPC-EN.       
           MOVE 1                       TO CIPC32R-QT-PRC-EN.           
           MOVE ADP061-CD-LOJA          TO CIPC32R-CHV-CD-INT-RLN.      
           MOVE ADP061-CD-VENDEDOR      TO CIPC32R-CHV-CD-INT-RLD.      
           EXEC CICS                                                    
               LINK  PROGRAM  ('CIPR32R')                               
                     COMMAREA (CIPC32R)                                 
                     LENGTH   (LENGTH OF CIPC32R)                       
           END-EXEC.                                                    
      *                                                                 
           IF CIPC32R-CD-RET-COD NOT EQUAL 0                            
              IF CIPC32R-CD-RET-COD NOT EQUAL 1                         
                 GO 049-00-99-EXIT                                      
              ELSE                                                      
                 GO 049-00-99-EXIT.                                     
                                                                        
            IF CD-IND-ATVA-REG-640(1) EQUAL 0                           
                 GO 049-00-99-EXIT.                                     
      *                                                                 
           INITIALIZE CIPC32I.                                          
           MOVE 1                       TO CIPC32I-CD-TPO-OPC-EN.       
           MOVE ADP061-CD-VENDEDOR      TO CIPC32I-CHV-CD-INT.          
           EXEC CICS                                                    
               LINK  PROGRAM  ('CIPR32I')                               
                     COMMAREA (CIPC32I)                                 
                     LENGTH   (LENGTH OF CIPC32I)                       
           END-EXEC.                                                    
      *                                                                 
           IF CIPC32I-CD-RET-COD NOT EQUAL 0                            
              IF CIPC32I-CD-RET-COD NOT EQUAL 1                         
                 GO 049-00-99-EXIT                                      
              ELSE                                                      
                 GO 049-00-99-EXIT                                      
           ELSE                                                         
               MOVE NM-INTERM-516    TO  VCRC080-S-NOME-VENDEDOR.       
                                                                        
CD6939 049-00-99-EXIT. EXIT.                                            
      /                                                                 
      *----------------------------------------------------------------*
021208*--->   NOVA REGRA PARA STATUS DE PROPOSTA ( NOVA CENTRAL )  <---*
      *----------------------------------------------------------------*
311005 050-00-ST-PROP-CENTRAL          SECTION.                         
      *                                                                 
021208     IF ADP061-CD-FILA-9      EQUAL 'CD' AND                      
021208        ADP061-CD-STATUS-9    EQUAL 'RE'                          
021208         MOVE 'AN'                  TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208     IF ADP061-CD-FILA-9      EQUAL 'CD' AND                      
021208        ADP061-CD-STATUS-9    EQUAL 'DC'                          
021208         MOVE 'DC'                  TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208     IF ADP061-CD-FILA-9      EQUAL 'CD' AND                      
021208        ADP061-CD-STATUS-9    EQUAL 'PG'                          
021208         MOVE 'AN'                  TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208     IF ADP061-CD-FILA-9      EQUAL 'FM'                          
021208         MOVE ADP061-CD-STATUS-9    TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208     IF ADP061-CD-FILA-9      EQUAL 'CH'                          
021208         MOVE 'CH'                  TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208     IF ADP061-CD-FILA-9      EQUAL 'AN'                          
021208         MOVE 'AN'                  TO ADP061-CD-STATUS           
021208     ELSE                                                         
021208         MOVE ADP061-CD-STATUS-9    TO ADP061-CD-STATUS.          
021208*                                                                 
311005 050-00-99-EXIT.                                                  
311005     EXIT.                                                        
      ******************************************************************
       080-00-FINALIZA                 SECTION.                         
      ***************************************************************** 
      *  FINALIDADE :                                                   
      *  - ROTINA DE FINALIZACAO DO PROGRAMA                            
      ***************************************************************** 
                                                                        
           IF      VCRC080-S-CD-RETORNO  EQUAL  ZEROES                  
             IF    WS-IND-S   GREATER ZEROES                            
                 MOVE  'CONSULTA EFETUADA COM SUCESSO ! '               
                   TO     VCRC080-S-DS-RETORNO                          
             ELSE                                                       
                 MOVE  'CONSULTA RETORNOU SEM DADOS ! ! '               
                   TO     VCRC080-S-DS-RETORNO.                         
      *                                                                 
           MOVE  +506     TO  VCRC080-C-TAM-ENTRADA.                    
           MOVE  +24070   TO  VCRC080-C-TAM-SAIDA.                      
      *                                                                 
           IF EIBCALEN   GREATER  ZEROS                                 
               MOVE  VCRC080-REG  TO  DFHCOMMAREA                       
           ELSE                                                         
               EXEC CICS  SEND                                          
                          FROM (VCRC080-REG)                            
CA1803                    LENGTH (WS-BIN-24573)                         
               END-EXEC                                                 
           END-IF.                                                      
      *                                                                 
                                                                        
           EXEC    CICS RETURN END-EXEC.                                
      *                                                                 
           GOBACK.                                                      
                                                                        
       080-00-FINALIZA-FIM. EXIT.                                       
      ***************************************************************** 
      /                                                                 
      ***************************************************************** 
      * FINALIDADE :                                                  * 
      * - CA'  DESLIGA-SE O HANDLE ABEND,FORMATA MENSAGEM INFORMATIVA * 
      *   E ENCERRA O PROGRAMA PASSANDO AS INFORMACOES PARA O         * 
      *   PROGRAMA CHAMADOR.                                          * 
      ***************************************************************** 
      *                                                                 
       100-00-LOGA-ABEND               SECTION.                         
                                                                        
           MOVE    DFHEIBLK            TO  WS-AREA-ABEND.               
                                                                        
           EXEC    CICS    LINK                                         
                           PROGRAM         ('@ABEND')                   
                           COMMAREA        (WS-AREA-ABEND)              
                           LENGTH          (LENGTH OF WS-AREA-ABEND)    
                           NOHANDLE                                     
           END-EXEC.                                                    
      *                                                                 
           GO       TO     080-00-FINALIZA.                             
      *                                                                 
       100-00-LOGA-ABEND-FIM.                                           
           EXIT.                                                        
      ***************************************************************** 
